(function(){var a;var b=[],c=[];var d=0;var e=+new Date+"";var f=75;var g=40;var h=" 	\f ﻿"+"\n\r\u2028\u2029"+" ᠎             　";var i=/\b__p \+= '';/g,j=/\b(__p \+=) '' \+/g,k=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var l=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var m=/\w*$/;var n=/^\s*function[ \n\r\t]+\w/;var o=/<%=([\s\S]+?)%>/g;var p=RegExp("^["+h+"]*0+(?=.$)");var q=/($^)/;var r=/\bthis\b/;var s=/['\n\r\t\u2028\u2029\\]/g;var t=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"];var u=0;var v="[object Arguments]",w="[object Array]",x="[object Boolean]",y="[object Date]",z="[object Function]",A="[object Number]",B="[object Object]",C="[object RegExp]",D="[object String]";var E={};E[z]=false;E[v]=E[w]=E[x]=E[y]=E[A]=E[B]=E[C]=E[D]=true;var F={leading:false,maxWait:0,trailing:false};var G={configurable:false,enumerable:false,value:null,writable:false};var H={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false};var I={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};var J=H[typeof window]&&window||this;var K=H[typeof exports]&&exports&&!exports.nodeType&&exports;var L=H[typeof module]&&module&&!module.nodeType&&module;var M=L&&L.exports===K&&K;var N=H[typeof global]&&global;if(N&&(N.global===N||N.window===N)){J=N}function O(a,b,c){var d=(c||0)-1,e=a?a.length:0;while(++d<e){if(a[d]===b){return d}}return-1}function P(a,b){var c=typeof b;a=a.cache;if(c=="boolean"||b==null){return a[b]?0:-1}if(c!="number"&&c!="string"){c="object"}var d=c=="number"?b:e+b;a=(a=a[c])&&a[d];return c=="object"?a&&O(a,b)>-1?0:-1:a?0:-1}function Q(a){var b=this.cache,c=typeof a;if(c=="boolean"||a==null){b[a]=true}else{if(c!="number"&&c!="string"){c="object"}var d=c=="number"?a:e+a,f=b[c]||(b[c]={});if(c=="object"){(f[d]||(f[d]=[])).push(a)}else{f[d]=true}}}function R(a){return a.charCodeAt(0)}function S(a,b){var c=a.criteria,d=b.criteria,e=-1,f=c.length;while(++e<f){var g=c[e],h=d[e];if(g!==h){if(g>h||typeof g=="undefined"){return 1}if(g<h||typeof h=="undefined"){return-1}}}return a.index-b.index}function T(a){var b=-1,c=a.length,d=a[0],e=a[c/2|0],f=a[c-1];if(d&&typeof d=="object"&&e&&typeof e=="object"&&f&&typeof f=="object"){return false}var g=W();g["false"]=g["null"]=g["true"]=g["undefined"]=false;var h=W();h.array=a;h.cache=g;h.push=Q;while(++b<c){h.push(a[b])}return h}function U(a){return"\\"+I[a]}function V(){return b.pop()||[]}function W(){return c.pop()||{array:null,cache:null,criteria:null,"false":false,index:0,"null":false,number:null,object:null,push:null,string:null,"true":false,undefined:false,value:null}}function X(a){a.length=0;if(b.length<g){b.push(a)}}function Y(a){var b=a.cache;if(b){Y(b)}a.array=a.cache=a.criteria=a.object=a.number=a.string=a.value=null;if(c.length<g){c.push(a)}}function Z(a,b,c){b||(b=0);if(typeof c=="undefined"){c=a?a.length:0}var d=-1,e=c-b||0,f=Array(e<0?0:e);while(++d<e){f[d]=a[b+d]}return f}function $(b){b=b?_.defaults(J.Object(),b,_.pick(J,t)):J;var c=b.Array,g=b.Boolean,I=b.Date,K=b.Function,L=b.Math,M=b.Number,N=b.Object,Q=b.RegExp,ab=b.String,bb=b.TypeError;var cb=[];var db=N.prototype;var eb=b._;var fb=db.toString;var gb=Q("^"+ab(fb).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");var hb=L.ceil,ib=b.clearTimeout,jb=L.floor,kb=K.prototype.toString,lb=Ub(lb=N.getPrototypeOf)&&lb,mb=db.hasOwnProperty,nb=cb.push,ob=b.setTimeout,pb=cb.splice,qb=cb.unshift;var rb=function(){try{var a={},b=Ub(b=N.defineProperty)&&b,c=b(a,a,a)&&b}catch(d){}return c}();var sb=Ub(sb=N.create)&&sb,tb=Ub(tb=c.isArray)&&tb,ub=b.isFinite,vb=b.isNaN,wb=Ub(wb=N.keys)&&wb,xb=L.max,yb=L.min,zb=b.parseInt,Ab=L.random;var Bb={};Bb[w]=c;Bb[x]=g;Bb[y]=I;Bb[z]=K;Bb[B]=N;Bb[A]=M;Bb[C]=Q;Bb[D]=ab;function Cb(a){return a&&typeof a=="object"&&!Zb(a)&&mb.call(a,"__wrapped__")?a:new Db(a)}function Db(a,b){this.__chain__=!!b;this.__wrapped__=a}Db.prototype=Cb.prototype;var Eb=Cb.support={};Eb.funcDecomp=!Ub(b.WinRTError)&&r.test($);Eb.funcNames=typeof K.name=="string";Cb.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:o,variable:"",imports:{_:Cb}};function Fb(a){var b=a[0],c=a[2],d=a[4];function e(){if(c){var a=Z(c);nb.apply(a,arguments)}if(this instanceof e){var f=Hb(b.prototype),g=b.apply(f,a||arguments);return zc(g)?g:f}return b.apply(d,a||arguments)}Vb(e,a);return e}function Gb(a,b,c,d,e){if(c){var f=c(a);if(typeof f!="undefined"){return f}}var g=zc(a);if(g){var h=fb.call(a);if(!E[h]){return a}var i=Bb[h];switch(h){case x:case y:return new i(+a);case A:case D:return new i(a);case C:f=i(a.source,m.exec(a));f.lastIndex=a.lastIndex;return f}}else{return a}var j=Zb(a);if(b){var k=!d;d||(d=V());e||(e=V());var l=d.length;while(l--){if(d[l]==a){return e[l]}}f=j?i(a.length):{}}else{f=j?Z(a):ec({},a)}if(j){if(mb.call(a,"index")){f.index=a.index}if(mb.call(a,"input")){f.input=a.input}}if(!b){return f}d.push(a);e.push(f);(j?Vc:nc)(a,function(a,g){f[g]=Gb(a,b,c,d,e)});if(k){X(d);X(e)}return f}function Hb(a,b){return zc(a)?sb(a):{}}if(!sb){Hb=function(){function a(){}return function(c){if(zc(c)){a.prototype=c;var d=new a;a.prototype=null}return d||b.Object()}}()}function Ib(a,b,c){if(typeof a!="function"){return $d}if(typeof b=="undefined"||!("prototype"in a)){return a}var d=a.__bindData__;if(typeof d=="undefined"){if(Eb.funcNames){d=!a.name}d=d||!Eb.funcDecomp;if(!d){var e=kb.call(a);if(!Eb.funcNames){d=!n.test(e)}if(!d){d=r.test(e);Vb(a,d)}}}if(d===false||d!==true&&d[1]&1){return a}switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return Jd(a,b)}function Jb(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5];var h=c&1,i=c&2,j=c&4,k=c&8,l=b;function m(){var a=h?f:this;if(d){var n=Z(d);nb.apply(n,arguments)}if(e||j){n||(n=Z(arguments));if(e){nb.apply(n,e)}if(j&&n.length<g){c|=16&~32;return Jb([b,k?c:c&~3,n,null,f,g])}}n||(n=arguments);if(i){b=a[l]}if(this instanceof m){a=Hb(b.prototype);var o=b.apply(a,n);return zc(o)?o:a}return b.apply(a,n)}Vb(m,a);return m}function Kb(a,b){var c=-1,d=Tb(),e=a?a.length:0,g=e>=f&&d===O,h=[];if(g){var i=T(b);if(i){d=P;b=i}else{g=false}}while(++c<e){var j=a[c];if(d(b,j)<0){h.push(j)}}if(g){Y(b)}return h}function Lb(a,b,c,d){var e=(d||0)-1,f=a?a.length:0,g=[];while(++e<f){var h=a[e];if(h&&typeof h=="object"&&typeof h.length=="number"&&(Zb(h)||Yb(h))){if(!b){h=Lb(h,b,c)}var i=-1,j=h.length,k=g.length;g.length+=j;while(++i<j){g[k++]=h[i]}}else if(!c){g.push(h)}}return g}function Mb(a,b,c,d,e,f){if(c){var g=c(a,b);if(typeof g!="undefined"){return!!g}}if(a===b){return a!==0||1/a==1/b}var h=typeof a,i=typeof b;if(a===a&&!(a&&H[h])&&!(b&&H[i])){return false}if(a==null||b==null){return a===b}var j=fb.call(a),k=fb.call(b);if(j==v){j=B}if(k==v){k=B}if(j!=k){return false}switch(j){case x:case y:return+a==+b;case A:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case C:case D:return a==ab(b)}var l=j==w;if(!l){var m=mb.call(a,"__wrapped__"),n=mb.call(b,"__wrapped__");if(m||n){return Mb(m?a.__wrapped__:a,n?b.__wrapped__:b,c,d,e,f)}if(j!=B){return false}var o=a.constructor,p=b.constructor;if(o!=p&&!(yc(o)&&o instanceof o&&yc(p)&&p instanceof p)&&("constructor"in a&&"constructor"in b)){return false}}var q=!e;e||(e=V());f||(f=V());var r=e.length;while(r--){if(e[r]==a){return f[r]==b}}var s=0;g=true;e.push(a);f.push(b);if(l){r=a.length;s=b.length;g=s==r;if(g||d){while(s--){var t=r,u=b[s];if(d){while(t--){if(g=Mb(a[t],u,c,d,e,f)){break}}}else if(!(g=Mb(a[s],u,c,d,e,f))){break}}}}else{lc(b,function(b,h,i){if(mb.call(i,h)){s++;return g=mb.call(a,h)&&Mb(a[h],b,c,d,e,f)}});if(g&&!d){lc(a,function(a,b,c){if(mb.call(c,b)){return g=--s>-1}})}}e.pop();f.pop();if(q){X(e);X(f)}return g}function Nb(a,b,c,d,e){(Zb(b)?Vc:nc)(b,function(b,f){var g,h,i=b,j=a[f];if(b&&((h=Zb(b))||Dc(b))){var k=d.length;while(k--){if(g=d[k]==b){j=e[k];break}}if(!g){var l;if(c){i=c(j,b);if(l=typeof i!="undefined"){j=i}}if(!l){j=h?Zb(j)?j:[]:Dc(j)?j:{}}d.push(b);e.push(j);if(!l){Nb(j,b,c,d,e)}}}else{if(c){i=c(j,b);if(typeof i=="undefined"){i=b}}if(typeof i!="undefined"){j=i}}a[f]=j})}function Ob(a,b){return a+jb(Ab()*(b-a+1))}function Pb(a,b,c){var d=-1,e=Tb(),g=a?a.length:0,h=[];var i=!b&&g>=f&&e===O,j=c||i?V():h;if(i){var k=T(j);e=P;j=k}while(++d<g){var l=a[d],m=c?c(l,d,a):l;if(b?!d||j[j.length-1]!==m:e(j,m)<0){if(c||i){j.push(m)}h.push(l)}}if(i){X(j.array);Y(j)}else if(c){X(j)}return h}function Qb(a){return function(b,c,d){var e={};c=Cb.createCallback(c,d,3);var f=-1,g=b?b.length:0;if(typeof g=="number"){while(++f<g){var h=b[f];a(e,h,c(h,f,b),b)}}else{nc(b,function(b,d,f){a(e,b,c(b,d,f),f)})}return e}}function Rb(a,b,c,d,e,f){var g=b&1,h=b&2,i=b&4,j=b&8,k=b&16,l=b&32;if(!h&&!yc(a)){throw new bb}if(k&&!c.length){b&=~16;k=c=false}if(l&&!d.length){b&=~32;l=d=false}var m=a&&a.__bindData__;if(m&&m!==true){m=Z(m);if(m[2]){m[2]=Z(m[2])}if(m[3]){m[3]=Z(m[3])}if(g&&!(m[1]&1)){m[4]=e}if(!g&&m[1]&1){b|=8}if(i&&!(m[1]&4)){m[5]=f}if(k){nb.apply(m[2]||(m[2]=[]),c)}if(l){qb.apply(m[3]||(m[3]=[]),d)}m[1]|=b;return Rb.apply(null,m)}var n=b==1||b===17?Fb:Jb;return n([a,b,c,d,e,f])}function Sb(a){return ac[a]}function Tb(){var a=(a=Cb.indexOf)===sd?O:a;return a}function Ub(a){return typeof a=="function"&&gb.test(a)}var Vb=!rb?be:function(a,b){G.value=b;rb(a,"__bindData__",G)};function Wb(a){var b,c;if(!(a&&fb.call(a)==B)||(b=a.constructor,yc(b)&&!(b instanceof b))){return false}lc(a,function(a,b){c=b});return typeof c=="undefined"||mb.call(a,c)}function Xb(a){return bc[a]}function Yb(a){return a&&typeof a=="object"&&typeof a.length=="number"&&fb.call(a)==v||false}var Zb=tb||function(a){return a&&typeof a=="object"&&typeof a.length=="number"&&fb.call(a)==w||false};var $b=function(a){var b,c=a,d=[];if(!c)return d;if(!H[typeof a])return d;for(b in c){if(mb.call(c,b)){d.push(b)}}return d};var _b=!wb?$b:function(a){if(!zc(a)){return[]}return wb(a)};var ac={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var bc=rc(ac);var cc=Q("("+_b(bc).join("|")+")","g"),dc=Q("["+_b(ac).join("")+"]","g");var ec=function(a,b,c){var d,e=a,f=e;if(!e)return f;var g=arguments,h=0,i=typeof c=="number"?2:g.length;if(i>3&&typeof g[i-2]=="function"){var j=Ib(g[--i-1],g[i--],2)}else if(i>2&&typeof g[i-1]=="function"){j=g[--i]}while(++h<i){e=g[h];if(e&&H[typeof e]){var k=-1,l=H[typeof e]&&_b(e),m=l?l.length:0;while(++k<m){d=l[k];f[d]=j?j(f[d],e[d]):e[d]}}}return f};function fc(a,b,c,d){if(typeof b!="boolean"&&b!=null){d=c;c=b;b=false}return Gb(a,b,typeof c=="function"&&Ib(c,d,1))}function gc(a,b,c){return Gb(a,true,typeof b=="function"&&Ib(b,c,1))}function hc(a,b){var c=Hb(a);return b?ec(c,b):c}var ic=function(a,b,c){var d,e=a,f=e;if(!e)return f;var g=arguments,h=0,i=typeof c=="number"?2:g.length;while(++h<i){e=g[h];if(e&&H[typeof e]){var j=-1,k=H[typeof e]&&_b(e),l=k?k.length:0;while(++j<l){d=k[j];if(typeof f[d]=="undefined")f[d]=e[d]}}}return f};function jc(a,b,c){var d;b=Cb.createCallback(b,c,3);nc(a,function(a,c,e){if(b(a,c,e)){d=c;return false}});return d}function kc(a,b,c){var d;b=Cb.createCallback(b,c,3);oc(a,function(a,c,e){if(b(a,c,e)){d=c;return false}});return d}var lc=function(a,b,c){var d,e=a,f=e;if(!e)return f;if(!H[typeof e])return f;b=b&&typeof c=="undefined"?b:Ib(b,c,3);for(d in e){if(b(e[d],d,a)===false)return f}return f};function mc(a,b,c){var d=[];lc(a,function(a,b){d.push(b,a)});var e=d.length;b=Ib(b,c,3);while(e--){if(b(d[e--],d[e],a)===false){break}}return a}var nc=function(a,b,c){var d,e=a,f=e;if(!e)return f;if(!H[typeof e])return f;b=b&&typeof c=="undefined"?b:Ib(b,c,3);var g=-1,h=H[typeof e]&&_b(e),i=h?h.length:0;while(++g<i){d=h[g];if(b(e[d],d,a)===false)return f}return f};function oc(a,b,c){var d=_b(a),e=d.length;b=Ib(b,c,3);while(e--){var f=d[e];if(b(a[f],f,a)===false){break}}return a}function pc(a){var b=[];lc(a,function(a,c){if(yc(a)){b.push(c)}});return b.sort()}function qc(a,b){return a?mb.call(a,b):false}function rc(a){var b=-1,c=_b(a),d=c.length,e={};while(++b<d){var f=c[b];e[a[f]]=f}return e}function sc(a){return a===true||a===false||a&&typeof a=="object"&&fb.call(a)==x||false}function tc(a){return a&&typeof a=="object"&&fb.call(a)==y||false}function uc(a){return a&&a.nodeType===1||false}function vc(a){var b=true;if(!a){return b}var c=fb.call(a),d=a.length;if(c==w||c==D||c==v||c==B&&typeof d=="number"&&yc(a.splice)){return!d}nc(a,function(){return b=false});return b}function wc(a,b,c,d){return Mb(a,b,typeof c=="function"&&Ib(c,d,2))}function xc(a){return ub(a)&&!vb(parseFloat(a))}function yc(a){return typeof a=="function"}function zc(a){return!!(a&&H[typeof a])}function Ac(a){return Cc(a)&&a!=+a}function Bc(a){return a===null}function Cc(a){return typeof a=="number"||a&&typeof a=="object"&&fb.call(a)==A||false}var Dc=!lb?Wb:function(a){if(!(a&&fb.call(a)==B)){return false}var b=a.valueOf,c=Ub(b)&&(c=lb(b))&&lb(c);return c?a==c||lb(a)==c:Wb(a)};function Ec(a){return a&&typeof a=="object"&&fb.call(a)==C||false}function Fc(a){return typeof a=="string"||a&&typeof a=="object"&&fb.call(a)==D||false}function Gc(a){return typeof a=="undefined"}function Hc(a,b,c){var d={};b=Cb.createCallback(b,c,3);nc(a,function(a,c,e){d[c]=b(a,c,e)});return d}function Ic(a){var b=arguments,c=2;if(!zc(a)){return a}if(typeof b[2]!="number"){c=b.length}if(c>3&&typeof b[c-2]=="function"){var d=Ib(b[--c-1],b[c--],2)}else if(c>2&&typeof b[c-1]=="function"){d=b[--c]}var e=Z(arguments,1,c),f=-1,g=V(),h=V();while(++f<c){Nb(a,e[f],d,g,h)}X(g);X(h);return a}function Jc(a,b,c){var d={};if(typeof b!="function"){var e=[];lc(a,function(a,b){e.push(b)});e=Kb(e,Lb(arguments,true,false,1));var f=-1,g=e.length;while(++f<g){var h=e[f];d[h]=a[h]}}else{b=Cb.createCallback(b,c,3);lc(a,function(a,c,e){if(!b(a,c,e)){d[c]=a}})}return d}function Kc(a){var b=-1,d=_b(a),e=d.length,f=c(e);while(++b<e){var g=d[b];f[b]=[g,a[g]]}return f}function Lc(a,b,c){var d={};if(typeof b!="function"){var e=-1,f=Lb(arguments,true,false,1),g=zc(a)?f.length:0;while(++e<g){var h=f[e];if(h in a){d[h]=a[h]}}}else{b=Cb.createCallback(b,c,3);lc(a,function(a,c,e){if(b(a,c,e)){d[c]=a}})}return d}function Mc(a,b,c,d){var e=Zb(a);if(c==null){if(e){c=[]}else{var f=a&&a.constructor,g=f&&f.prototype;c=Hb(g)}}if(b){b=Cb.createCallback(b,d,4);(e?Vc:nc)(a,function(a,d,e){return b(c,a,d,e)})}return c}function Nc(a){var b=-1,d=_b(a),e=d.length,f=c(e);while(++b<e){f[b]=a[d[b]]}return f}function Oc(a){var b=arguments,d=-1,e=Lb(b,true,false,1),f=b[2]&&b[2][b[1]]===a?1:e.length,g=c(f);while(++d<f){g[d]=a[e[d]]}return g}function Pc(a,b,c){var d=-1,e=Tb(),f=a?a.length:0,g=false;c=(c<0?xb(0,f+c):c)||0;if(Zb(a)){g=e(a,b,c)>-1}else if(typeof f=="number"){g=(Fc(a)?a.indexOf(b,c):e(a,b,c))>-1}else{nc(a,function(a){if(++d>=c){return!(g=a===b)}})}return g}var Qc=Qb(function(a,b,c){mb.call(a,c)?a[c]++:a[c]=1});function Rc(a,b,c){var d=true;b=Cb.createCallback(b,c,3);var e=-1,f=a?a.length:0;if(typeof f=="number"){while(++e<f){if(!(d=!!b(a[e],e,a))){break}}}else{nc(a,function(a,c,e){return d=!!b(a,c,e)})}return d}function Sc(a,b,c){var d=[];b=Cb.createCallback(b,c,3);var e=-1,f=a?a.length:0;if(typeof f=="number"){while(++e<f){var g=a[e];if(b(g,e,a)){d.push(g)}}}else{nc(a,function(a,c,e){if(b(a,c,e)){d.push(a)}})}return d}function Tc(a,b,c){b=Cb.createCallback(b,c,3);var d=-1,e=a?a.length:0;if(typeof e=="number"){while(++d<e){var f=a[d];if(b(f,d,a)){return f}}}else{var g;nc(a,function(a,c,d){if(b(a,c,d)){g=a;return false}});return g}}function Uc(a,b,c){var d;b=Cb.createCallback(b,c,3);Wc(a,function(a,c,e){if(b(a,c,e)){d=a;return false}});return d}function Vc(a,b,c){var d=-1,e=a?a.length:0;b=b&&typeof c=="undefined"?b:Ib(b,c,3);if(typeof e=="number"){while(++d<e){if(b(a[d],d,a)===false){break}}}else{nc(a,b)}return a}function Wc(a,b,c){var d=a?a.length:0;b=b&&typeof c=="undefined"?b:Ib(b,c,3);if(typeof d=="number"){while(d--){if(b(a[d],d,a)===false){break}}}else{var e=_b(a);d=e.length;nc(a,function(a,c,f){c=e?e[--d]:--d;return b(f[c],c,f)})}return a}var Xc=Qb(function(a,b,c){(mb.call(a,c)?a[c]:a[c]=[]).push(b)});var Yc=Qb(function(a,b,c){a[c]=b});function Zc(a,b){var d=Z(arguments,2),e=-1,f=typeof b=="function",g=a?a.length:0,h=c(typeof g=="number"?g:0);Vc(a,function(a){h[++e]=(f?b:a[b]).apply(a,d)});return h}function $c(a,b,d){var e=-1,f=a?a.length:0;b=Cb.createCallback(b,d,3);if(typeof f=="number"){var g=c(f);while(++e<f){g[e]=b(a[e],e,a)}}else{g=[];nc(a,function(a,c,d){g[++e]=b(a,c,d)})}return g}function _c(a,b,c){var d=-Infinity,e=d;if(typeof b!="function"&&c&&c[b]===a){b=null}if(b==null&&Zb(a)){var f=-1,g=a.length;while(++f<g){var h=a[f];if(h>e){e=h}}}else{b=b==null&&Fc(a)?R:Cb.createCallback(b,c,3);Vc(a,function(a,c,f){var g=b(a,c,f);if(g>d){d=g;e=a}})}return e}function ad(a,b,c){var d=Infinity,e=d;if(typeof b!="function"&&c&&c[b]===a){b=null}if(b==null&&Zb(a)){var f=-1,g=a.length;while(++f<g){var h=a[f];if(h<e){e=h}}}else{b=b==null&&Fc(a)?R:Cb.createCallback(b,c,3);Vc(a,function(a,c,f){var g=b(a,c,f);if(g<d){d=g;e=a}})}return e}var bd=$c;function cd(a,b,c,d){if(!a)return c;var e=arguments.length<3;b=Cb.createCallback(b,d,4);var f=-1,g=a.length;if(typeof g=="number"){if(e){c=a[++f]}while(++f<g){c=b(c,a[f],f,a)}}else{nc(a,function(a,d,f){c=e?(e=false,a):b(c,a,d,f)})}return c}function dd(a,b,c,d){var e=arguments.length<3;b=Cb.createCallback(b,d,4);Wc(a,function(a,d,f){c=e?(e=false,a):b(c,a,d,f)});return c}function ed(a,b,c){b=Cb.createCallback(b,c,3);return Sc(a,function(a,c,d){return!b(a,c,d)})}function fd(b,c,d){if(b&&typeof b.length!="number"){b=Nc(b)}if(c==null||d){return b?b[Ob(0,b.length-1)]:a}var e=gd(b);e.length=yb(xb(0,c),e.length);return e}function gd(a){var b=-1,d=a?a.length:0,e=c(typeof d=="number"?d:0);Vc(a,function(a){var c=Ob(0,++b);e[b]=e[c];e[c]=a});return e}function hd(a){var b=a?a.length:0;return typeof b=="number"?b:_b(a).length}function id(a,b,c){var d;b=Cb.createCallback(b,c,3);var e=-1,f=a?a.length:0;if(typeof f=="number"){while(++e<f){if(d=b(a[e],e,a)){break}}}else{nc(a,function(a,c,e){return!(d=b(a,c,e))})}return!!d}function jd(a,b,d){var e=-1,f=Zb(b),g=a?a.length:0,h=c(typeof g=="number"?g:0);if(!f){b=Cb.createCallback(b,d,3)}Vc(a,function(a,c,d){var g=h[++e]=W();if(f){g.criteria=$c(b,function(b){return a[b]})}else{(g.criteria=V())[0]=b(a,c,d)}g.index=e;g.value=a});g=h.length;h.sort(S);while(g--){var i=h[g];h[g]=i.value;if(!f){X(i.criteria)}Y(i)}return h}function kd(a){if(a&&typeof a.length=="number"){return Z(a)}return Nc(a)}var ld=Sc;function md(a){var b=-1,c=a?a.length:0,d=[];while(++b<c){var e=a[b];if(e){d.push(e)}}return d}function nd(a){return Kb(a,Lb(arguments,true,true,1))}function od(a,b,c){var d=-1,e=a?a.length:0;b=Cb.createCallback(b,c,3);while(++d<e){if(b(a[d],d,a)){return d}}return-1}function pd(a,b,c){var d=a?a.length:0;b=Cb.createCallback(b,c,3);while(d--){if(b(a[d],d,a)){return d}}return-1}function qd(b,c,d){var e=0,f=b?b.length:0;if(typeof c!="number"&&c!=null){var g=-1;c=Cb.createCallback(c,d,3);while(++g<f&&c(b[g],g,b)){e++}}else{e=c;if(e==null||d){return b?b[0]:a}}return Z(b,0,yb(xb(0,e),f))}function rd(a,b,c,d){if(typeof b!="boolean"&&b!=null){d=c;c=typeof b!="function"&&d&&d[b]===a?null:b;b=false}if(c!=null){a=$c(a,c,d)}return Lb(a,b)}function sd(a,b,c){if(typeof c=="number"){var d=a?a.length:0;c=c<0?xb(0,d+c):c||0}else if(c){var e=Bd(a,b);return a[e]===b?e:-1}return O(a,b,c)}function td(a,b,c){var d=0,e=a?a.length:0;if(typeof b!="number"&&b!=null){var f=e;b=Cb.createCallback(b,c,3);while(f--&&b(a[f],f,a)){d++}}else{d=b==null||c?1:b||d}return Z(a,0,yb(xb(0,e-d),e))}function ud(){var a=[],b=-1,c=arguments.length,d=V(),e=Tb(),g=e===O,h=V();while(++b<c){var i=arguments[b];if(Zb(i)||Yb(i)){a.push(i);d.push(g&&i.length>=f&&T(b?a[b]:h))}}var j=a[0],k=-1,l=j?j.length:0,m=[];a:while(++k<l){var n=d[0];i=j[k];if((n?P(n,i):e(h,i))<0){b=c;(n||h).push(i);while(--b){n=d[b];if((n?P(n,i):e(a[b],i))<0){continue a}}m.push(i)}}while(c--){n=d[c];if(n){Y(n)}}X(d);X(h);return m}function vd(b,c,d){var e=0,f=b?b.length:0;if(typeof c!="number"&&c!=null){var g=f;c=Cb.createCallback(c,d,3);while(g--&&c(b[g],g,b)){e++}}else{e=c;if(e==null||d){return b?b[f-1]:a}}return Z(b,xb(0,f-e))}function wd(a,b,c){var d=a?a.length:0;if(typeof c=="number"){d=(c<0?xb(0,d+c):yb(c,d-1))+1}while(d--){if(a[d]===b){return d}}return-1}function xd(a){var b=arguments,c=0,d=b.length,e=a?a.length:0;while(++c<d){var f=-1,g=b[c];while(++f<e){if(a[f]===g){pb.call(a,f--,1);e--}}}return a}function yd(a,b,d){a=+a||0;d=typeof d=="number"?d:+d||1;if(b==null){b=a;a=0}var e=-1,f=xb(0,hb((b-a)/(d||1))),g=c(f);while(++e<f){g[e]=a;a+=d}return g}function zd(a,b,c){var d=-1,e=a?a.length:0,f=[];b=Cb.createCallback(b,c,3);while(++d<e){var g=a[d];if(b(g,d,a)){f.push(g);pb.call(a,d--,1);e--}}return f}function Ad(a,b,c){if(typeof b!="number"&&b!=null){var d=0,e=-1,f=a?a.length:0;b=Cb.createCallback(b,c,3);while(++e<f&&b(a[e],e,a)){d++}}else{d=b==null||c?1:xb(0,b)}return Z(a,d)}function Bd(a,b,c,d){var e=0,f=a?a.length:e;c=c?Cb.createCallback(c,d,1):$d;b=c(b);while(e<f){var g=e+f>>>1;c(a[g])<b?e=g+1:f=g}return e}function Cd(){return Pb(Lb(arguments,true,true))}function Dd(a,b,c,d){if(typeof b!="boolean"&&b!=null){d=c;c=typeof b!="function"&&d&&d[b]===a?null:b;b=false}if(c!=null){c=Cb.createCallback(c,d,3)}return Pb(a,b,c)}function Ed(a){return Kb(a,Z(arguments,1))}function Fd(){var a=-1,b=arguments.length;while(++a<b){var c=arguments[a];if(Zb(c)||Yb(c)){var d=d?Pb(Kb(d,c).concat(Kb(c,d))):c}}return d||[]}function Gd(){var a=arguments.length>1?arguments:arguments[0],b=-1,d=a?_c(bd(a,"length")):0,e=c(d<0?0:d);while(++b<d){e[b]=bd(a,b)}return e}function Hd(a,b){var c=-1,d=a?a.length:0,e={};if(!b&&d&&!Zb(a[0])){b=[]}while(++c<d){var f=a[c];if(b){e[f]=b[c]}else if(f){e[f[0]]=f[1]}}return e}function Id(a,b){if(!yc(b)){throw new bb}return function(){if(--a<1){return b.apply(this,arguments)}}}function Jd(a,b){return arguments.length>2?Rb(a,17,Z(arguments,2),null,b):Rb(a,1,null,null,b)}function Kd(a){var b=arguments.length>1?Lb(arguments,true,false,1):pc(a),c=-1,d=b.length;while(++c<d){var e=b[c];a[e]=Rb(a[e],1,null,null,a)}return a}function Ld(a,b){return arguments.length>2?Rb(b,19,Z(arguments,2),null,a):Rb(b,3,null,null,a)}function Md(){var a=arguments,b=a.length;while(b--){if(!yc(a[b])){throw new bb}}return function(){var b=arguments,c=a.length;while(c--){b=[a[c].apply(this,b)]}return b[0]}}function Nd(a,b){b=typeof b=="number"?b:+b||a.length;return Rb(a,4,null,null,null,b)}function Od(b,c,d){var e,f,g,h,i,j,k,l=0,m=false,n=true;if(!yc(b)){throw new bb}c=xb(0,c)||0;if(d===true){var o=true;n=false}else if(zc(d)){o=d.leading;m="maxWait"in d&&(xb(c,d.maxWait)||0);n="trailing"in d?d.trailing:n}var p=function(){var d=c-(ce()-h);if(d<=0){if(f){ib(f)}var m=k;f=j=k=a;if(m){l=ce();g=b.apply(i,e);if(!j&&!f){e=i=null}}}else{j=ob(p,d)}};var q=function(){if(j){ib(j)}f=j=k=a;if(n||m!==c){l=ce();g=b.apply(i,e);if(!j&&!f){e=i=null}}};return function(){e=arguments;h=ce();i=this;k=n&&(j||!o);if(m===false){var a=o&&!j}else{if(!f&&!o){l=h}var d=m-(h-l),r=d<=0;if(r){if(f){f=ib(f)}l=h;g=b.apply(i,e)}else if(!f){f=ob(q,d)}}if(r&&j){j=ib(j)}else if(!j&&c!==m){j=ob(p,c)}if(a){r=true;g=b.apply(i,e)}if(r&&!j&&!f){e=i=null}return g}}function Pd(b){if(!yc(b)){throw new bb}var c=Z(arguments,1);return ob(function(){b.apply(a,c)},1)}function Qd(b,c){if(!yc(b)){throw new bb}var d=Z(arguments,2);return ob(function(){b.apply(a,d)},c)}function Rd(a,b){if(!yc(a)){throw new bb}var c=function(){var d=c.cache,f=b?b.apply(this,arguments):e+arguments[0];return mb.call(d,f)?d[f]:d[f]=a.apply(this,arguments)};c.cache={};return c}function Sd(a){var b,c;if(!yc(a)){throw new bb}return function(){if(b){return c}b=true;c=a.apply(this,arguments);a=null;return c}}function Td(a){return Rb(a,16,Z(arguments,1))}function Ud(a){return Rb(a,32,null,Z(arguments,1))}function Vd(a,b,c){var d=true,e=true;if(!yc(a)){throw new bb}if(c===false){d=false}else if(zc(c)){d="leading"in c?c.leading:d;e="trailing"in c?c.trailing:e}F.leading=d;F.maxWait=b;F.trailing=e;return Od(a,b,F)}function Wd(a,b){return Rb(b,16,[a])}function Xd(a){return function(){return a}}function Yd(a,b,c){var d=typeof a;if(a==null||d=="function"){return Ib(a,b,c)}if(d!="object"){return ee(a)}var e=_b(a),f=e[0],g=a[f];if(e.length==1&&g===g&&!zc(g)){return function(a){var b=a[f];return g===b&&(g!==0||1/g==1/b)}}return function(b){var c=e.length,d=false;while(c--){if(!(d=Mb(b[e[c]],a[e[c]],null,true))){break}}return d}}function Zd(a){return a==null?"":ab(a).replace(dc,Sb)}function $d(a){return a}function _d(a,b,c){var d=true,e=b&&pc(b);if(!b||!c&&!e.length){if(c==null){c=b}f=Db;b=a;a=Cb;e=pc(b)}if(c===false){d=false}else if(zc(c)&&"chain"in c){d=c.chain}var f=a,g=yc(f);Vc(e,function(c){var e=a[c]=b[c];if(g){f.prototype[c]=function(){var b=this.__chain__,c=this.__wrapped__,g=[c];nb.apply(g,arguments);var h=e.apply(a,g);if(d||b){if(c===h&&zc(h)){return this}h=new f(h);h.__chain__=b}return h}}})}function ae(){b._=eb;return this}function be(){}var ce=Ub(ce=I.now)&&ce||function(){return(new I).getTime()};var de=zb(h+"08")==8?zb:function(a,b){return zb(Fc(a)?a.replace(p,""):a,b||0)};function ee(a){return function(b){return b[a]}}function fe(a,b,c){var d=a==null,e=b==null;if(c==null){if(typeof a=="boolean"&&e){c=a;a=1}else if(!e&&typeof b=="boolean"){c=b;e=true}}if(d&&e){b=1}a=+a||0;if(e){b=a;a=0}else{b=+b||0}if(c||a%1||b%1){var f=Ab();return yb(a+f*(b-a+parseFloat("1e-"+((f+"").length-1))),b)}return Ob(a,b)}function ge(a,b){if(a){var c=a[b];return yc(c)?a[b]():c}}function he(b,c,d){var e=Cb.templateSettings;b=ab(b||"");d=ic({},d,e);var f=ic({},d.imports,e.imports),g=_b(f),h=Nc(f);var m,n=0,p=d.interpolate||q,r="__p += '";var t=Q((d.escape||q).source+"|"+p.source+"|"+(p===o?l:q).source+"|"+(d.evaluate||q).source+"|$","g");b.replace(t,function(a,c,d,e,f,g){d||(d=e);r+=b.slice(n,g).replace(s,U);if(c){r+="' +\n__e("+c+") +\n'"}if(f){m=true;r+="';\n"+f+";\n__p += '"}if(d){r+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"}n=g+a.length;return a});r+="';\n";var v=d.variable,w=v;if(!w){v="obj";r="with ("+v+") {\n"+r+"\n}\n"}r=(m?r.replace(i,""):r).replace(j,"$1").replace(k,"$1;");r="function("+v+") {\n"+(w?"":v+" || ("+v+" = {});\n")+"var __t, __p = '', __e = _.escape"+(m?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+r+"return __p\n}";var x="\n/*\n//# sourceURL="+(d.sourceURL||"/lodash/template/source["+u++ +"]")+"\n*/";try{var y=K(g,"return "+r+x).apply(a,h)}catch(z){z.source=r;throw z}if(c){return y(c)}y.source=r;return y}function ie(a,b,d){a=(a=+a)>-1?a:0;var e=-1,f=c(a);b=Ib(b,d,1);while(++e<a){f[e]=b(e)}return f}function je(a){return a==null?"":ab(a).replace(cc,Xb)}function ke(a){var b=++d;return ab(a==null?"":a)+b}function le(a){a=new Db(a);a.__chain__=true;return a}function me(a,b){b(a);return a}function ne(){this.__chain__=true;return this}function oe(){return ab(this.__wrapped__)}function pe(){return this.__wrapped__}Cb.after=Id;Cb.assign=ec;Cb.at=Oc;Cb.bind=Jd;Cb.bindAll=Kd;Cb.bindKey=Ld;Cb.chain=le;Cb.compact=md;Cb.compose=Md;Cb.constant=Xd;Cb.countBy=Qc;Cb.create=hc;Cb.createCallback=Yd;Cb.curry=Nd;Cb.debounce=Od;Cb.defaults=ic;Cb.defer=Pd;Cb.delay=Qd;Cb.difference=nd;Cb.filter=Sc;Cb.flatten=rd;Cb.forEach=Vc;Cb.forEachRight=Wc;Cb.forIn=lc;Cb.forInRight=mc;Cb.forOwn=nc;Cb.forOwnRight=oc;Cb.functions=pc;Cb.groupBy=Xc;Cb.indexBy=Yc;Cb.initial=td;Cb.intersection=ud;Cb.invert=rc;Cb.invoke=Zc;Cb.keys=_b;Cb.map=$c;Cb.mapValues=Hc;Cb.max=_c;Cb.memoize=Rd;Cb.merge=Ic;Cb.min=ad;Cb.omit=Jc;Cb.once=Sd;Cb.pairs=Kc;Cb.partial=Td;Cb.partialRight=Ud;Cb.pick=Lc;Cb.pluck=bd;Cb.property=ee;Cb.pull=xd;Cb.range=yd;Cb.reject=ed;Cb.remove=zd;Cb.rest=Ad;Cb.shuffle=gd;Cb.sortBy=jd;Cb.tap=me;Cb.throttle=Vd;Cb.times=ie;Cb.toArray=kd;Cb.transform=Mc;Cb.union=Cd;Cb.uniq=Dd;Cb.values=Nc;Cb.where=ld;Cb.without=Ed;Cb.wrap=Wd;Cb.xor=Fd;Cb.zip=Gd;Cb.zipObject=Hd;Cb.collect=$c;Cb.drop=Ad;Cb.each=Vc;Cb.eachRight=Wc;Cb.extend=ec;Cb.methods=pc;Cb.object=Hd;Cb.select=Sc;Cb.tail=Ad;Cb.unique=Dd;Cb.unzip=Gd;_d(Cb);Cb.clone=fc;Cb.cloneDeep=gc;Cb.contains=Pc;Cb.escape=Zd;Cb.every=Rc;Cb.find=Tc;Cb.findIndex=od;Cb.findKey=jc;Cb.findLast=Uc;Cb.findLastIndex=pd;Cb.findLastKey=kc;Cb.has=qc;Cb.identity=$d;Cb.indexOf=sd;Cb.isArguments=Yb;Cb.isArray=Zb;Cb.isBoolean=sc;Cb.isDate=tc;Cb.isElement=uc;Cb.isEmpty=vc;Cb.isEqual=wc;Cb.isFinite=xc;Cb.isFunction=yc;Cb.isNaN=Ac;Cb.isNull=Bc;Cb.isNumber=Cc;Cb.isObject=zc;Cb.isPlainObject=Dc;Cb.isRegExp=Ec;Cb.isString=Fc;Cb.isUndefined=Gc;Cb.lastIndexOf=wd;Cb.mixin=_d;Cb.noConflict=ae;Cb.noop=be;Cb.now=ce;Cb.parseInt=de;Cb.random=fe;Cb.reduce=cd;Cb.reduceRight=dd;Cb.result=ge;Cb.runInContext=$;Cb.size=hd;Cb.some=id;Cb.sortedIndex=Bd;Cb.template=he;Cb.unescape=je;Cb.uniqueId=ke;Cb.all=Rc;Cb.any=id;Cb.detect=Tc;Cb.findWhere=Tc;Cb.foldl=cd;Cb.foldr=dd;Cb.include=Pc;Cb.inject=cd;_d(function(){var a={};nc(Cb,function(b,c){if(!Cb.prototype[c]){a[c]=b}});return a}(),false);Cb.first=qd;Cb.last=vd;Cb.sample=fd;Cb.take=qd;Cb.head=qd;nc(Cb,function(a,b){var c=b!=="sample";if(!Cb.prototype[b]){Cb.prototype[b]=function(b,d){var e=this.__chain__,f=a(this.__wrapped__,b,d);return!e&&(b==null||d&&!(c&&typeof b=="function"))?f:new Db(f,e)}}});Cb.VERSION="2.4.1";Cb.prototype.chain=ne;Cb.prototype.toString=oe;Cb.prototype.value=pe;Cb.prototype.valueOf=pe;Vc(["join","pop","shift"],function(a){var b=cb[a];Cb.prototype[a]=function(){var a=this.__chain__,c=b.apply(this.__wrapped__,arguments);return a?new Db(c,a):c}});Vc(["push","reverse","sort","unshift"],function(a){var b=cb[a];Cb.prototype[a]=function(){b.apply(this.__wrapped__,arguments);return this}});Vc(["concat","slice","splice"],function(a){var b=cb[a];Cb.prototype[a]=function(){return new Db(b.apply(this.__wrapped__,arguments),this.__chain__)}});return Cb}var _=$();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){J._=_;define(function(){return _})}else if(K&&L){if(M){(L.exports=_)._=_}else{K._=_}}else{J._=_}}).call(this);var j$=jQuery.noConflict();if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Object.create){Object.create=function(){function a(){}return function(b){a.prototype=b;return new a}}()}"use strict";(function(a,b,c,d,e,f,g){a["GoogleAnalyticsObject"]=e;a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date;f=b.createElement(c),g=b.getElementsByTagName(c)[0];f.async=1;f.src=d;g.parentNode.insertBefore(f,g)})(window,document,"script","//www.google-analytics.com/analytics.js","dco");var CSQ=angular.module("dementia.connect",["ngAnimate","ngTouch","ui.router"]);CSQ.config(["$stateProvider","$httpProvider","$sceProvider","$sceDelegateProvider","$locationProvider",function a(b,c,d,e,f){f.hashPrefix("!");e.resourceUrlWhitelist(["self"]);b.state("root",{template:'<div cq-alert="default" popover="true" dismiss="true" fadeout="true"></div>'+'<p class="cq-sr-alert" role="alert" aria-live="assertive" aria-atomic="true"></p>'+'<div ui-view cq-default-focus ng-class="{smallContainer:smallContainer,largeContainer:largeContainer}"></div>',resolve:{loaded:["$rootScope",function(a){return a.loaded}]}}).state("loading",{template:"<h1>Loading</h1>"}).state("loadfail",{template:"<h1>Load Failed</h1><p>{{loadError}}</p>"})}]);CSQ.factory("$exceptionHandler",["$log","$injector",function b(a,c){return function(b,d){a.error(b);if(d)a.error(d);var e=c.get("$rootScope");e.alert({exception:b,cause:d})}}]);CSQ.directive("cqAlert",["$rootScope","$timeout",function c(a,b){var c=null;var d=function(a){a.removeClass("cq-alert-success cq-alert-info cq-alert-warning cq-alert-error cq-alert-fade-out");a.html("").css("opacity","0")};var e=function(e,f,g){f.addClass("cq-alert");f.css("opacity","0");if(g.popover=="true")f.addClass("cq-alert-popover");var h=g.fadeout;var i=g.cqAlert||"low";if(!_.contains(["low","medium","high","default"],i))throw new Error("Invalid cq-alert priority: "+i);a.$on("AppAlert_"+i,function(e,i){d(f);if(i==null||!f.is(":visible"))return;
a.log("Displaying alert:",i);var j=i.html;if(g.dismiss!="false")j='<button type="button" class="close">&times;</button>'+j;j="<div>"+j+"</div>";f.html(j);f.addClass("cq-alert-"+i.severity);f.find("button").click(function(){a.clearAlert()});f.css("opacity","1");e.preventDefault();if(h){var k=2e4;if(c)b.cancel(c);c=b(function(){f.addClass("cq-alert-fade-out");f.css("opacity","0");b(function(){a.clearAlert()},1e3);c=null},k)}});a.$on("AppAlertClear",function(){d(f)})};return{restrict:"A",link:e}}]);CSQ.directive("cqSrefActive",["$state","$stateParams","$interpolate",function d(a,b,c){function d(a){var b=a.parent().inheritedData("$uiView");if(b&&b.state&&b.state.name){return b.state}}return{restrict:"A",controller:["$scope","$element","$attrs",function(e,f,g){var h=null,i=null,j=null;j=c(g.cqSrefActive||"",false)(e);this.$$setStateInfo=function(b,c){h=a.get(b,d(f));i=c;k()};e.$on("$stateChangeSuccess",k);function k(){if(a.includes(h.name,i)){f.addClass(j)}else{f.removeClass(j)}}function l(){return!i||equalForKeys(i,b)}}]}}]);CSQ.directive("cqSref",["$state","$timeout","$rootScope",function e(a,b,c){var d=["location","inherit","reload"];function e(a){var b=a.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!b||b.length!==4)throw new Error("Invalid state ref '"+a+"'");return{state:b[1],paramExpr:b[3]||null}}function f(a){var b=a.parent().inheritedData("$uiView");if(b&&b.state&&b.state.name){return b.state}}return{restrict:"A",require:"?^cqSrefActive",link:function(g,h,i,j){var k=e(i.cqSref);var l=null,m=null,n=f(h)||a.$current;var o=h[0].nodeName==="FORM";var p=o?"action":"href",q=true;var r={relative:n};var s=g.$eval(i.uiSrefOpts)||{};angular.forEach(d,function(a){if(a in s){r[a]=s[a]}});var t=function(b){if(b)l=b;if(!q)return;var c=a.href(k.state,l,r);if(j){j.$$setStateInfo(k.state,l)}if(!c){q=false;return false}h[0][p]=c};if(k.paramExpr){g.$watch(k.paramExpr,function(a,b){if(a!==l)t(a)},true);l=g.$eval(k.paramExpr)}t();if(o)return;h.bind("click",function(a){var d=a.which||a.button;if(!(d>1||a.ctrlKey||a.metaKey||a.shiftKey||h.attr("target"))){b(function(){c.go(k.state,l,r)});a.preventDefault()}})}}}]);CSQ.run(["$rootScope","$log","$window","$timeout","$location","$q","$state","$http","RestError","$injector",function f(a,b,c,d,e,g,h,i,j,k){a.log=function(a,c){if(c!==undefined)a+=" :: "+JSON.stringify(c);b.log(a)};a.smallContainer=false;a.largeContainer=false;a.stateTransitioning=false;a.statePriorToCurrent="";a.lastScrollPositionForState={};a.viewState={};var l=function u(a,b){var c=b?"<strong>":"";var d=b?"</strong>":"";var e=b?"&nbsp;":" ";var f="";if(a.exception instanceof j)a=a.exception;if(a instanceof j){f=c+a.message}else if(a.success){f=a.success}else if(a.info){f=a.info}else if(a.error){var g=a.reason;if(g instanceof j){f=c+a.error+d+" "+e+g.message+". "+(g.diagnosticMessage||"")}else if(g){f=c+a.error+d+" "+e+(_.isObject(g)?JSON.stringify(g):g)}else{f=a.error}}else if(a.warning){f=a.warning}else if(a.exception){f=c+"Exception:"+d+e+a.exception}else if(a instanceof Error){f=c+"Exception:"+d+e+e+a.constructor.name+e+"-"+e+a.message}else if(a.message){f=a.message}else{f=_.isObject(a)?JSON.stringify(a):a;f=f.replace(/,/g,", ")}return f};var m=function(a){if(a.exception instanceof j)a=a.exception;if(a instanceof j){return"error"}else if(a.success){return"success"}else if(a.info){return"info"}else if(a.error){return"error"}else if(a.warning){return"warning"}else if(a.exception){return"error"}else{return"error"}};a.srAlert=function(b){var c=j$(".cq-sr-alert");if(c.length==0)return;c=j$(c[0]);c.html("");if(b==null)return;j$(".cq-sr-alert").append("<p>"+l(b,false)+"</p>");if(b&&b!="Loading"&&b!="loading")a.log("SR Alert",b)};a.alert=function(b){if(b==null){a.clearAlert();return}a.srAlert(b);var c={text:l(b,false),html:l(b,true),severity:m(b)};var d=a.$broadcast("AppAlert_high",c);if(d.defaultPrevented)return;var d=a.$broadcast("AppAlert_medium",c);if(d.defaultPrevented)return;var d=a.$broadcast("AppAlert_low",c);if(d.defaultPrevented)return;var d=a.$broadcast("AppAlert_default",c);if(d.defaultPrevented)return;a.log("Alert: ",b)};a.setAlert=a.alert;a.clearAlert=function(){a.$broadcast("AppAlertClear")};a.logout=function(){i({method:"GET",url:"j_spring_logout"}).success(function(b,c,d,e){h.go("notauth");a.currentUser=null}).error(function(b,c,d,e){a.alert("Logout failed: "+c)})};var n={};a.go=function(a,b,c){var d=a;if(c&&c.relative){if(d[0]=="^"){d=c.relative.parent.name+d.substr(1)}else{d=c.relative.name+d}}var f=h.get(d);if(!f)throw new Error("Invalid state name: "+d);var g=d.split(".");if(g.length==2){var i=n[g[1]];if(i)e.url(i);else h.go(d,b,c)}else if(!b){var i=n[f.name];if(i)b=i;h.go(d,b,c)}else{h.go(d,b,c)}};a.$on("$stateChangeStart",function(b,c,d,e,f){a.srAlert("Loading");a.lastScrollPositionForState[e.name]={params:f,scrollTop:j$(window).scrollTop()};a.stateTransitioning=true});a.$on("$stateChangeSuccess",function(b,c,d,f,g){a.srAlert(null);a.stateTransitioning=false;a.statePriorToCurrent=f?f.name:"";var h=c.name.split(".");if(h.length>1){n[h[1]]=e.url()}if(!_.isEmpty(d)){n[c.name]=d}});a.$on("$stateChangeError",function(b,c,d,e,f,g){a.stateTransitioning=false;a.log(g);a.alert(g)});var o=g.defer();a.loaded=o.promise;var p=k.has("UserModel")?k.get("UserModel"):null;var q=k.has("AppLoader")?k.get("AppLoader"):null;var r=function(){if(q&&q.authenticateUser){if(!p)throw new Error("AppLoader has authenticateUser=true but no UserModel class is defined");return p.currentUser()}else{return g.when(null)}};var s=function(){if(q)return q.loadData();else return g.when(null)};r().then(function(b){a.currentUser=b;s().then(function(a){o.resolve(true)})},function(b){a.log(b);h.go("loadfail");a.loadError=b;o.reject(b)});var t=function(b){a.$broadcast("PULSE",b);d(function(){t(b+1)},2e3)};t(0)}]);if(!window.console){window.console={};window.console.log=function(){}}CSQ.factory("ClassUtils",function(){"use strict";var a=Object.create;if(!_.isFunction(a)){a=function(a){function b(){}b.prototype=a;return new b}}return{bindMethods:function b(a,c){_.each(a.prototype,function(a,b){if(_.isFunction(a)&&b!=="constructor"&&b!=="__proto__"){Object.defineProperty(c,b,{value:_.bind(a,c),enumerable:false,writeable:false,configurable:false});_.bindAll(c,b)}})},inheritPrototype:function c(b,d){var e=a(d.prototype);e.constructor=b;b.prototype=e},addProperties:function d(a,b){_.each(b,function(b,c){if(_.isFunction(b)){Object.defineProperty(a,c,{get:b})}else{Object.defineProperty(a,c,{value:b})}})},addMethods:function e(a,b){_.each(b,function(b,c){if(!_.isFunction(b))throw new Error("Not a function:"+b);Object.defineProperty(a,c,{value:b,writable:false})})}}});CSQ.service("configService",["$rootScope","$state","$injector",function g(a,b,c){"use strict";var d=null;var e=null;var f=false;var g=true;var h=8;var i=[{id:"C1",label:"Information, support and advice",tooltip:"Information, support and advice",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-info-circle",color:"#83C9FD",types:["Dementia adviser","Dementia support","Information programme","Dementia cafe","Advice and support (emotional)","Advice and support (general)","Information and Advice (Dementia)","Information provision","Information and Advice (Financial & Legal)","Advice and support (financial)","Dementia Support & Groups","Telephone helpline","Telephone helplines","Online forum"]},{id:"C2",label:"Care or support in the home",tooltip:"Care or support in the home",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-home",color:"rgb(158,202,29)",types:["Registered home care and support","Community support service","Befriending","Befriending / home support","Home facilities & services","Registered home care and support"]},{id:"C3",label:"Support in the community",tooltip:"Support in the community",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-male",color:"rgb(243,104,194)",types:["Dementia cafe","Community support service","Day care and support (establishment based)","Carer support and groups","Carer Support & Groups","Counselling","Befriending","Befriending / home support","Peer support group","Lifestyle & Wellbeing","Dementia Support & Groups","Carer training"]},{id:"C4",label:"Activities and social groups",tooltip:"Activities and social groups",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-coffee",color:"#CF78F4",types:["Dementia cafe","Singing for the Brain","Befriending","Befriending / home support","Activity group","Community support service","Dementia cafe","Dementia Support & Groups","Lifestyle & Wellbeing"]},{id:"C5",label:"Day care",tooltip:"Day care",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-plus-circle",color:"#FC5669",types:["Day care and support (establishment based)","Day support / day care"]},{id:"C6",label:"Advocacy",tooltip:"Advocacy",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-bullhorn",color:"#570255",types:["Advocacy"]},{id:"C7",label:"Respite",tooltip:"Respite",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-refresh",color:"#C78C04",types:["Day care and support (establishment based)","Day support / day care","Registered home care and support","Community support service","Befriending","Befriending / home support","Respite"]},{id:"C9",label:"Transport",tooltip:"Transport",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",icon:"fa-bus",color:"#5700A8",types:["Transport, Driving & Mobility","Transport"]}];this.setConfig=function(a){d=a||{};e=d.categories||i;f=false;if(typeof d.searchBarTooltipSeconds=="number")h=d.searchBarTooltipSeconds;var b=[];g=true;_.each(e,function(a){_.each(a.types,function(a){if(_.contains(b,a))g=false;b.push(a)})})};this.getDefaultService=function(){return defaultService};this.getSearchBarTooltipSeconds=function(){return h};this.isGlobal=function(){return d.global||true};this.isHomePage=function(){if(d.isHomePage===true)return true;return d.isHomePage||false};this.getShowAlzheimers=function(){return d.alzonly||false};this.uniqueCategories=function(){return g};this.getTitle=function(){return d.title||"Dementia Connect"};this.getShowHelp=function(){if(d.showHelp===true)return true;return d.showHelp||false};this.getSearchResultsTitle=function(){return d.searchResultsTitle||"Local Services"};this.getSplash=function(){if(d.splash===0||d.splash===false)return 0;if(d.splash<4)return 2400;return d.splash||0};this.getAlzOnly=function(){return f};this.setAlzOnly=function(a){f=a};this.getProvidedBy=function(){if(d.providedBy===false)return false;return d.providedBy||true;H};this.getCategories=function(){return angular.copy(e.sort(function(a,b){return a.label>b.label?1:-1}))};this.getCategoryForId=function(a){return _.findWhere(this.getCategories(),{id:a})};this.getCategoriesForType=function(a){return _.where(e,function(b){return _.contains(b.types,a)})};this.getTypesForCategories=function(a){var b=[];if(!a||!a.length)return null;_.each(e,function(c){if(_.contains(a,c.id))_.each(c.types,function(a){b.push(a)})});return b};this.getTypeStringForCategories=function(a,b){var c=this.getTypesForCategories(a);if(!c)return null;var d="";_.each(c,function(a){if(d.length)d+=b;d+=a});return d}}]);CSQ.directive("cqFocusCapture",["$rootScope","$parse",function h(a,b){"use strict";var c={tab:9,enter:13,escape:27,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40};function d(a){var b,c,d,e=a.nodeName.toLowerCase(),f=!isNaN(j$.attr(a,"tabindex"));if("area"===e){b=a.parentNode;c=b.name;if(!a.href||!c||b.nodeName.toLowerCase()!=="map"){return false}d=j$("img[usemap=#"+c+"]")[0];return!!d&&g(d)}return(/input|select|textarea|button|object/.test(e)?!a.disabled:"a"===e?a.href||f:f)&&g(a);function g(a){return j$.expr.filters.visible(a)&&!j$(a).parents().addBack().filter(function(){return j$.css(this,"visibility")==="hidden"}).length}}var e=function(b,e,f){var g="dialog";var h=null;function i(a){var b=document.activeElement;if(!b)return-1;var c=a.index(b);if(c>=0)return c;b=j$(b).closest('[cq-focus-capture="group"]');return b.length?a.index(b[0]):-1}function j(a){if(f.cqFocusCapture=="list")return j$(a).parent().closest("[cq-focus-capture]").is(e);return j$(a).parent().closest('[cq-focus-capture][cq-focus-capture!="list"]').is(e)}function k(a){return a.find("*").filter(function(){return d(this)&&j(this)})}function l(a,b){var c=b.get(a);if(!c)return;h=c;c=j$(c);if(c.is("input:radio")){c.prop("checked",true);c.attr("checked","checked");setTimeout(function(){c.click()})}c.focus()}function m(){var a=k(e);if(a.length)l(0,a)}function n(){var a=k(e);if(a.length)l(a.length-1,a)}function o(a){var b=k(e);var c=i(b);if(c==b.length-1&&a)return;l(c==b.length-1?0:c+1,b)}function p(a){var b=k(e);var c=i(b);if(c==0&&a)return;if(c<0)c=0;l(c-1,b)}f.$observe("cqFocusCapture",function(b){if(b!="dialog"&&b!="dialogmenu"&&b!="group"&&b!="list"){a.log(e[0]);throw new Error('Invalid value "'+b+'" for cq-focus-capture attribute')}g=b;if(g=="dialogmenu"){var c=k(e);var d=_.findIndex(c,function(a){return j$(a).is("input:radio:checked")});if(d>=0)l(d,c)}else if(g=="group"){e.attr("tabindex","0");e.focus(function(){var a=k(e);var b=_.findIndex(a,function(a){return j$(a).is("input:radio:checked")});if(b<0)b=h?a.index(h):-1;if(b<0)b=0;l(b,a)})}});b.$watch(function(){return e.is(":visible")},function(a,b){if(a&&!b){h=null;if(j$(e).parent().closest("[cq-focus-capture]").length==0){m()}}});e.on("keydown",function(a){b.$apply(function(){switch(a.keyCode){case c.tab:if(g=="dialog"||g=="dialogmenu"){a.shiftKey?p():o();a.preventDefault()}break;case c.escape:if(g=="dialog"||g=="dialogmenu"){e.hide();a.preventDefault()}break;case c.down_arrow:case c.right_arrow:if(j$(a.target).is('input[type="text"],textarea'))break;if(g=="group"||g=="dialogmenu"||g=="list"){o(g=="list")}a.preventDefault();break;case c.up_arrow:case c.left_arrow:if(j$(a.target).is('input[type="text"],textarea'))break;if(g=="group"||g=="dialogmenu"||g=="list"){p(g=="list")}a.preventDefault();break}})});e.on("focusin",function(a){var b=j$(a.target);if(b.is("input[type=radio],input[type=checkbox]"))b.closest("label,[cq-focus-container]").addClass("cq-focus-container-active")});e.on("focusout",function(a){j$(a.target).closest("label,[cq-focus-container]").removeClass("cq-focus-container-active")})};return{restrict:"A",link:e}}]);CSQ.directive("cqMap",["$parse",function i(a){function b(a,b){google.maps.event.trigger(a,"resize");var c=null;function d(b){var c=b.lng<a.getBounds().getCenter().lng();return new InfoBox({alignBottom:true,pixelOffset:new google.maps.Size(c?15:-175,-40),content:b.info,boxStyle:{background:"#ffffff",color:"black",opacity:.9,width:"160px",padding:"6px",fontSize:"11px",textAlign:c?"left":"right"},maxWidth:0,zIndex:200,closeBoxURL:"",isHidden:false,pane:"floatPane",disableAutoPan:true,enableEventPropagation:false})}_.each(b,function(b){google.maps.event.addListener(b.marker,"mouseover",function(){if(!b.info)return;c=setTimeout(function(){b.infobox=d(b);b.infobox.open(a,b.marker)},500)});google.maps.event.addListener(b.marker,"mouseout",function(){if(c){clearTimeout(c);c=null}if(b.infobox){b.infobox.close();b.infobox=null}})})}function c(a,b){var c=0;var d=false;google.maps.event.addListener(a,"tilesloaded",function(a){d=true});google.maps.event.addListener(a,"zoom_changed",function(){if(d)return;console.log("zoom_changed:"+a.getZoom());if(a.getZoom()>b){if(c&&c<=b)a.setZoom(c);console.log("set:"+c)}});google.maps.event.addListener(a,"bounds_changed",function(){if(d)return;console.log("bounds_changed:"+a.getZoom());c=a.getZoom();if(a.getZoom()>b){a.setZoom(b);console.log("set:"+b)}})}function d(a,b,c,d){c=c||34;d=d||16;function e(a,c){var d=b.fromLatLngToContainerPixel(new google.maps.LatLng(a.lat,a.lng));var e=b.fromLatLngToContainerPixel(new google.maps.LatLng(c.lat,c.lng));return Math.sqrt(Math.pow(d.x-e.x,2)+Math.pow(d.y-e.y,2))}function f(a){this.markers=[];this.boundingBox=new google.maps.LatLngBounds;this.location=null;this.expanded=false;this.includesOrigin=false;this.minDistance=Number.MAX_VALUE;this.capture=function(a){this.markers.push(a);this.boundingBox.extend(new google.maps.LatLng(a.lat,a.lng));this.location=this.boundingBox.getCenter();if(a.originMarker)this.includesOrigin=true};this.captureIfNearby=function(a){var b=Number.MAX_VALUE;_.each(this.markers,function(c){b=Math.min(b,e(a,c))});if(b>c)return false;this.capture(a);this.minDistance=Math.min(this.minDistance,b);this.markers=_.sortBy(this.markers,function(a){return-a.lng});return true};if(a)this.capture(a)}var g=[];_.each(a,function(a){var b=_.find(g,function(b){return b.captureIfNearby(a)});if(!b)g.push(new f(a))});this.clusters=_.filter(g,function(a){return a.minDistance<(a.markers.length<3?d:d+3)})}function e(a,b){var c=null;var e=false;var f=new google.maps.OverlayView;f.setMap(a);f.onAdd=function(){_.each(b,function(b){b.flyoutLine=new google.maps.Polyline({map:a,visible:false,path:[new google.maps.LatLng(0,0),new google.maps.LatLng(0,0)],strokeColor:"blue",strokeOpacity:1,strokeWeight:1,icons:!b.originMarker?[{icon:{path:google.maps.SymbolPath.CIRCLE,scale:2,fillColor:"blue",fillOpacity:.8},offset:"0%"}]:[]});google.maps.event.addListener(b.marker,"mouseover",function(){var a=g(b);if(a&&!a.expanded){h(a);return}})});google.maps.event.addListener(a,"mousemove",function(a){_.each(c,function(b){if(b.expanded&&!b.flyinZone.contains(a.latLng))i(b)})})};f.draw=function(){var g=new d(b,f.getProjection(),34);c=g.clusters;_.each(c,function(b){var c=j(b.location,60,80);var d=j(b.location,-60,-38);b.flyinZone=new google.maps.LatLngBounds(d,c);c=j(b.location,50,70);d=j(b.location,-50,-34);var f=a.getBounds();if(!e&&(!f.contains(d)||!f.contains(c))){f.extend(c);f.extend(d);a.fitBounds(f)}var g=b.includesOrigin?34:b.markers.length>4?32:26;var h=b.includesOrigin?(Math.PI+1.8)/Math.max(1,b.markers.length-2):2*Math.PI/b.markers.length;var i=b.includesOrigin?-.9:-.2;var k=0;_.each(b.markers,function(a){var c=new google.maps.LatLng(a.lat,a.lng);a.flyinPosition=c;if(a.originMarker){a.flyoutPosition=c;a.flyoutLine.setPath([c,c])}else{a.flyoutPosition=j(b.location,g*Math.cos(i+h*k),g*Math.sin(i+h*k));a.flyoutLine.setPath([c,a.flyoutPosition]);k++}})});var h=new d(b,f.getProjection(),3);_.each(h.clusters,function(a){var b=a.includesOrigin?12:a.markers.length>3?6:3;var c=a.includesOrigin?(Math.PI+1)/Math.max(1,a.markers.length-2):2*Math.PI/a.markers.length;var d=a.includesOrigin?-.5:0;var e=a.includesOrigin?5:0;var f=0;_.each(a.markers,function(a){var g=new google.maps.LatLng(a.lat,a.lng);if(!a.originMarker){a.flyinPosition=j(g,b*Math.cos(d+c*f),b*Math.sin(d+c*f)+e);a.marker.setPosition(a.flyinPosition);f++}})})};google.maps.event.addListener(a,"tilesloaded",function(a){e=true});function g(a){return _.find(c,function(b){return _.contains(b.markers,a)})}function h(a){if(a.expanded)return;if(a.markers.length<2||a.includesOrigin&&a.markers.length<3)return;var b=_.filter(a.markers,function(a){return!a.originMarker});b=_.map(b,function(a){return{lat:a.flyinPosition.lat(),lng:a.flyinPosition.lng()}});var c=new d(b,f.getProjection(),999,16);if(c.clusters.length==0)return;a.expanded=true;_.each(a.markers,function(a){a.marker.setZIndex(google.maps.Marker.MAX_ZINDEX);a.marker.setPosition(a.flyoutPosition);a.flyoutLine.setVisible(true)})}function i(a){a.expanded=false;_.each(a.markers,function(a){a.marker.setZIndex(undefined);a.marker.setPosition(a.flyinPosition);a.flyoutLine.setVisible(false)})}function j(a,b,c){var d=f.getProjection().fromLatLngToContainerPixel(a);d.x+=b;d.y-=c;return f.getProjection().fromContainerPixelToLatLng(d)}}var f=["$scope","$attrs","$element",function(d,f,g){d.resizeMap=function(){google.maps.event.trigger(d.gmap,"resize");d.gmap.setCenter(d.center);return true};var h=a(f.cqMap)(d);var i=h.center;var j=h.zoom||15;var k=h.events||{};var l=h.markers||[];var m=h.mapEvents||{};var n=h.markerEvents||{};var o=h.options?angular.copy(h.options):{};o.zoom=j;o.center=new google.maps.LatLng(i.lat,i.lng);var p=new google.maps.LatLngBounds;p.extend(o.center);var q=new google.maps.Map(g[0],o);_.each(k,function(a,b){google.maps.event.addListener(q,b,function(){a.call(q,b,q)})});_.each(l,function(a){var b=new google.maps.LatLng(a.lat,a.lng);var c=new google.maps.Marker({map:q,position:b,options:a.options});a.marker=c;_.each(n,function(b,d){google.maps.event.addListener(c,d,function(){b.call(a,d,a)})});p.extend(b)});var r=new c(q,15);var s=new b(q,l);var t=new e(q,l);if(l.length>1)q.fitBounds(p);d.gmap=q;d.center=q.getCenter()}];return{restrict:"A",controller:f}}]);CSQ.controller("DetailController",["selectedService","drivingDistance","$scope","$rootScope","$state","$timeout","ServiceModel","searchService","geocodeService","configService","$window","$location",function j(a,b,c,d,e,f,g,h,i,k,l,m){c.serviceModel=a;c.drivingData=b;c.providedBy=k.getProvidedBy();if(d.ANALYTICS)l.dco("send","pageview",{page:m.absUrl()});var n=a.Default_Location__r!=null?a.Default_Location__r.City__c:h.service_city__c;var o=a.Operated_By__r!=null?a.Operated_By__r.Name:a.Id;document.title=a.Service_Web_Name__c+" - "+n+" - "+o;c.findMore=function(){var a={place:c.serviceModel.service_postcode__c};e.go("root.results.list",{q:JSON.stringify(a)})};if(k.getProvidedBy()){var p=document.getElementsByName("robots");if(p.length==0){var q=document.createElement("meta");q.name="robots";q.content="noindex, nofollow";document.getElementsByTagName("head")[0].appendChild(q)}else{p[0].setAttribute("content","noindex, nofollow")}}var r={zoom:15,center:{lat:a.Default_Location__r!=null?a.Default_Location__r.Geographic_Location__Latitude__s:a.Location__Latitude__s,lng:a.Default_Location__r!=null?a.Default_Location__r.Geographic_Location__Longitude__s:a.Location__Longitude__s},options:{scrollwheel:false,panControl:false,mapTypeControl:false,draggable:d.largeContainer,streetViewControl:d.largeContainer},markers:[{lat:a.Default_Location__r!=null?a.Default_Location__r.Geographic_Location__Latitude__s:a.Location__Latitude__s,lng:a.Default_Location__r!=null?a.Default_Location__r.Geographic_Location__Longitude__s:a.Location__Longitude__s}]};c.serviceModel.cqc="";if(c.serviceModel.Id=="a0z70000000L7rHAAS")c.serviceModel.cqc="1-447059081";if(c.serviceModel.Id=="a0z70000000L7jtAAC")c.serviceModel.cqc="1-135989102";if(c.serviceModel.Id=="a0z70000000L7rJAAS")c.serviceModel.cqc="1-974085583";if(c.serviceModel.Id=="a0z70000000L7hjAAC")c.serviceModel.cqc="1-974085583";if(c.serviceModel.Id=="a0z70000000L7i1AAC")c.serviceModel.cqc="1-136010240";if(c.serviceModel.Id=="a0z70000000L7szAAC")c.serviceModel.cqc="1-136010268";if(c.serviceModel.Id=="a0z70000000L7ixAAC")c.serviceModel.cqc="1-431234880";if(c.serviceModel.Id=="a0z70000000DwifAAC")c.serviceModel.cqc="1-1601800621";if(c.serviceModel.Id=="a0z70000000L7odAAC")c.serviceModel.cqc="1-397738421";if(c.serviceModel.cqc!=""){(function(a){if(!a.CQCWidget){a.CQCWidget={}}var b=a.CQCWidget;if(!b.processedScripts){b.processedScripts=[]}var d=b.processedScripts;if(!b.styleTags){b.styleTags=[]}var e=b.styleTags;var f=document.getElementById("cqc");d.push(f);var g="data-id="+c.serviceModel.cqc+"&data-host=www.cqc.org.uk";var h=JSON.parse('{"'+decodeURI(g).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');var i=location.protocol;var j="www.cqc.org.uk";var k=i+"//"+j;var l="CQCWidgetDisplayWidget";if(e.length==0){var m=document.createElement("link");m.rel="stylesheet";m.type="text/css";var n=k+"/sites/all/modules/custom/cqc_widget/cleanslate.css";m.href=n;m.media="all";document.getElementsByTagName("head")[0].appendChild(m);e.push(m);var m=document.createElement("link");m.rel="stylesheet";m.type="text/css";var n=k+"/sites/all/modules/custom/cqc_widget/cqc-widget-styles.css";m.href=n;m.media="all";document.getElementsByTagName("head")[0].appendChild(m);e.push(m)}var o=document.createElement("div");var p=new Date;var q=1;o.id="CQCWidget-"+c.serviceModel.cqc+"-"+q;var r=k+"/ajax/cqc_widget/"+c.serviceModel.cqc+"/"+o.id;o.className="cqc-widget cleanslate";f.parentNode.insertBefore(o,f);s(r);function s(a){var b=document.getElementsByTagName("head")[0];var c=document.createElement("script");a+="?callback="+l;c.setAttribute("src",a);b.appendChild(c)}})(this)}c.map=r}]);function CQCWidgetDisplayWidget(a){document.getElementById(a.id).innerHTML=a.response}"use strict";CSQ.directive("cqPaginate",["$rootScope","$parse",function k(a,b){"use strict";var c=["$scope","$element","$attrs",function(a,c,d){var e=d.cqPaginate;var f=e.match(/^\s*([\s\S]+?)\s+as\s+([\s\S]+?)$/);if(!f){throw new Error("Expected expression in form '_list_ as _collection_' but got "+e)}var g=f[1];var h=f[2];var i=b(g)(a);var j={page:0};var k={pageNumber:0,pageSize:10,pageOrder:null,numberOfElements:0,firstElementOrdinal:0,lastElementOrdinal:0,firstPage:true,lastPage:true,totalElements:0,totalPages:0,content:[]};a.$watch(d.cqPage,function(b,c){j=b;i.readPage(j).then(function(b){a[h]=b})},true);this.getPageHolder=function(){return a[h]};this.getPageRequest=function(){return j}}];c.$inject=["$scope","$element","$attrs"];return{scope:true,restrict:"A",controller:c}}]);CSQ.directive("cqPageControls",["$rootScope","$parse","$compile",function l(a,b,c){"use strict";var d={pageNumberAndCount:"<span>Page <strong>{{1+getPageRequest().page}}</strong> of <strong>{{getPageHolder().totalPages}}</strong>&nbsp;&nbsp;",nextButton:'<button class="btn" aria-label="Next page" style="padding:2px 5px 2px 7px" ng-click="nextPage()" ng-disabled="getPageHolder().lastPage||transit()">Next <i class="fa fa-caret-right"></i></button> ',prevButton:'<button class="btn" aria-label="Previous page" style="padding:2px 7px 2px 5px" ng-click="prevPage()" ng-disabled="getPageHolder().firstPage||transit()"><i class="fa fa-caret-left"></i> Prev</button> ',elementRangeAndCount:"<span>Showing <b>{{1+getPageHolder().firstElementOrdinal}}</b> to <b>{{1+getPageHolder().lastElementOrdinal}}</b> of <b>{{getPageHolder().totalElements}}</b>&nbsp;</span>",totalPages:"</span>Total pages <b>{{getPageHolder().totalPages}}</b></span>",pageSizeButton:'<button cq-popover="popoverSpec" class="btn" style="border-radius:12px;padding:2px 8px" aria-label="set page size" ng-disabled="transit()">{{getPageHolder().pageSize}} items per page <i class="caret"></i></button>',pageSizeMenu:'<span tabindex="0">Items per page&nbsp;&nbsp;<b class="cq-page-controls-size-toggle" style="cursor:pointer;display:inline-block" cq-popover="popoverSpec" xng-click="showMenu($event)">{{getPageHolder().pageSize}}<i class="caret"></i></b></span>',_pageSizeDropdown:'<div class="popover bottom" id="{{popoverSpec.id}}" cq-focus-capture="dialogmenu">'+'<div class="arrow"></div>'+'<div class="popover-content" style="padding: 0 6px" role="dialog" aria-label="set page size" >'+' <ul class="popover-menu" cq-capture-mousewheel cq-key-to-click>'+'<li ng-click="setPageSize($event,4)" role="button" aria-label="show four items per page" tabindex="-1">4</li>'+'<li ng-click="setPageSize($event,5)" role="button" aria-label="show five items per page" tabindex="-1">5</li>'+'<li ng-click="setPageSize($event,8)" role="button" aria-label="show eight items per page" tabindex="-1">8</li>'+'<li ng-click="setPageSize($event,10)" role="button" aria-label="show ten items per page" tabindex="-1">10</li>'+'<li ng-click="setPageSize($event,15)" role="button" aria-label="show fifteen items per page" tabindex="-1">15</li>'+'<li ng-click="setPageSize($event,20)" role="button" aria-label="show twenty items per page" tabindex="-1">20</li>'+'<li ng-click="setPageSize($event,25)" role="button" aria-label="show twenty-five items per page" tabindex="-1">25</li>'+'<li ng-click="setPageSize($event,30)" role="button" aria-label="show thirty items per page" tabindex="-1">30</li>'+'<li ng-click="setPageSize($event,40)" role="button" aria-label="show forty items per page" tabindex="-1">40</li>'+"</ul>"+"</div>"+"</div>"};var e=function(b,e,f,g){var h=false;function i(){e.find(".popover").hide()}b.popoverSpec={id:_.uniqueId("dc-page-size-menu")};var j=null;if(!g){var k=f["for"];if(!k){throw new Error('The cq-page-controls directive must be within a cq-paginate directive or must use the "for" attribute')}j=angular.element("#"+k+"[cq-paginate]");if(j.length==0){throw new Error('Invalid id in "for" attribute for cq-page-controls')}}b.setPageSize=function(a,c){a.preventDefault();a.stopPropagation();var d=b.getPageRequest();if(d.page!==0){var e=Math.floor(d.page*d.size/c);d.page=e}d.size=c;i()};b.getPageHolder=function(){var b=g||j.controller("cqPaginate");if(!b)return{};if(b.getPageHolder()&&!h){h=true;a.$evalAsync(function(){a.$broadcast("CqPageControlsBuilt")})}return b.getPageHolder()||{}};b.getPageRequest=function(){var a=g||j.controller("cqPaginate");if(!a)return{};return a.getPageRequest()||{}};b.nextPage=function(){var a=b.getPageRequest();
var c=b.getPageHolder();if(!a)return;a.page=a.page+1};b.prevPage=function(){var a=b.getPageRequest();if(!a||a.page<=0)return;a.page=a.page-1};b.transit=function(){return a.stateTransitioning};if(!b.cqPageControls)return;var l=b.cqPageControls.split(",");if(_.contains(l,"pageSizeButton")||_.contains(l,"pageSizeMenu"))l.push("_pageSizeDropdown");var m="";_.forEach(l,function(a){m+=d[a]||""});var n=c(m);var o=n(b);e.append(o)};return{scope:{cqPageControls:"@"},restrict:"A",require:"?^cqPaginate",link:e}}]);CSQ.directive("cqPopover",["$rootScope","$timeout","$parse",function m(a,b,c){"use strict";var d=false;function e(){angular.element(".cq-popover-tag").hide()}function f(a){var b=angular.element("#"+a);if(!a||b.length==0)throw new Error("Invalid id passed to cqPopover:"+a);b.addClass("cq-popover-tag");return b}var g=function(c,g,h){var i={};c.$watch(h.cqPopover,function(a){i=a});function j(){e();var b=f(i.id);if(i.beforeShow)i.beforeShow(b);b.show();b.position({my:"top+4",at:"bottom",of:g});var d=c.$watch(function(){return b.is(":visible")},function(b,c){if(!b&&c){d();if(!a.stateTransitioning&&j$("body").find(".cq-popover-tag:visible").length==0)g.focus()}})}g.on("click",function(a){b(function(){var a=f(i.id);if(a.is(":visible"))return;j()},10)});g.on("keydown",function(a){c.$apply(function(){var b=f(i.id);if(b.is("button"))return;if(b.is(":visible"))return;if(a.keyCode==13||a.keyCode==32){a.preventDefault();a.stopPropagation();j()}})});if(!d){j$("html").bind("click focusin",function(a){if(j$(".cq-popover-tag:visible").length==0)return;if(j$(a.target).closest(".cq-popover-tag").length)return;c.$apply(function(){e()})});d=true}};return{restrict:"A",link:g}}]);CSQ.directive("cqFormControl",["$rootScope","$parse",function n(a,b){"use strict";var c=function(b,c,d,e){var f=c.find("[ng-transclude]");if(f.children().length==0||f.children().length>2){a.log(f[0]);throw new Error("Content of cq-form-control must consist of one or two elements")}var g=f.find(":first-child");var h=f.find(":nth-child(2)");if(h.length==0)return;h.addClass("form-control");b.$watch(function(){return e.editing},function(a,b){if(a){g.addClass("ng-hide");h.removeClass("ng-hide")}else{h.addClass("ng-hide");g.removeClass("ng-hide")}});b.$watch(function(){return e.saving},function(a,b){if(a){h.attr("disabled","disabled");h.prop("disabled",true)}else{h.removeAttr("disabled");h.prop("disabled",false)}})};return{scope:{cqFormControl:"@"},restrict:"A",transclude:true,template:"<div>"+'<div class="col-sm-2">'+'<label xxfor="">{{cqFormControl}}</label>'+"</div>"+'<div class="col-sm-4" ng-transclude></div>'+"</div>",require:"^cqFormModel",link:c}}]);CSQ.directive("cqEditControls",["$rootScope","$parse",function o(a,b){"use strict";var c=function(a,b,c,d){a.form=d};return{scope:true,restrict:"A",template:"<div>"+'<button ng-hide="form.editing" ng-click="form.editBegin()" class="btn btn-mini btn-primary"><i class="icon-edit"></i>&nbsp;Edit</button> '+'<button ng-show="form.editing" ng-disabled="!form.saveable" ng-click="form.editSave()" class="btn btn-mini btn-primary">Save</button> '+'<button ng-show="form.editing" ng-click="form.editCancel()" class="btn btn-mini btn-warning">Cancel</button> '+'<button ng-show="form.editing" ng-disabled="!form.saveable" ng-click="form.editFinish()" class="btn btn-mini btn-success">Finish</button>'+"</div>",require:"^cqFormModel",link:c}}]);CSQ.directive("cqScrollTop",["$rootScope","$window",function p(a,b){"use strict";var c=function(a,c,d){b.scrollTo(0,0)};return{restrict:"A",link:c}}]);CSQ.directive("cqKeyToClick",["$rootScope","$window",function q(a,b){"use strict";var c=function(a,b,c){b.on("keydown",function(a){if(a.keyCode==32||a.keyCode==13){j$(a.target).trigger("click");a.preventDefault()}})};return{restrict:"A",link:c}}]);CSQ.directive("cqFocusVisibility",["$rootScope","$window",function r(a,b){"use strict";var c=function(a,b,c){function d(c){a.$apply(function(){if(c.keyCode==9||c.keyCode==27||c.keyCode>36&&c.keyCode<41){b.removeClass("hideFocus")}})}b.on("keyup",d);b.on("keydown",d);b.on("keypress",d);b.addClass("hideFocus")};return{restrict:"A",link:c}}]);CSQ.directive("cqFormModel",["$rootScope","$q","ClassUtils",function s(a,b,c){"use strict";var d=["$scope","$element","$attrs",function(d,e,f){var g=this;var h=null;var i=null;var j=false;var k=false;var l={};var m=e.controller("form");if(!m)throw new Error('Could not find required controller "form"');var n=f.cqFormModel;var o=n.match(/^\s*([\s\S]+?)\s+as\s+([\s\S]+?)(?:\s+with\s+controller\s+as\s+([\s\S]+?))?\s*$/);if(!o){throw new Error("Expected expression in form '_model_ as _name_ [with controller as _name_] but got "+n)}var p=o[1];var q=o[2];var r=o[3];if(r)d[r]=this;d.$watch(p,function(b,c){if(!b){a.log("null valaue: "+p);return}h=b;i=s(h);d[q]=i;if(d.editMode)d.editBegin()});var s=function(a){var b=Object.create(a);_.each(Object.getOwnPropertyNames(a),function(c){var d=Object.getOwnPropertyDescriptor(a,c);if(_.isFunction(d.value))return;if(!d.writable&&!d.set)return;Object.defineProperty(b,c,{enumerable:true,configurable:false,set:function(a){l[c]=a},get:function(){return _.has(l,c)?l[c]:a[c]}})});return b};var t=function(){l={}};var u=function(){return m.$valid&&!_.isEmpty(l)};var v=function(a){if(a.hasOwnProperty("id"))return true;if(a.hasOwnProperty("jsClass"))return true;return _.contains(_.values(a),undefined)};var w=function(){if(!j||!u()){return b.when(true)}if(v(l))throw new Error("Bad changeset:"+JSON.stringify(l));a.clearAlert();k=true;return h.patch(l).then(function(a){k=false;t();return true},function(c){k=false;a.log(c);t();a.setAlert(c);return b.reject(c)})};var x=function(){t();j=true;d.$broadcast("cq-edit-begin")};var y=function(){j=false;t();d.$broadcast("cq-edit-end")};var z=function(){return w()};var A=function(){a.clearAlert();y()};var B=function(){w().then(function(a){y();return a})};c.addProperties(this,{editing:function(){return j},saving:function(){return k},saveable:u,valid:function(){return m.$valid}});c.addMethods(this,{editBegin:x,editCancel:A,editSave:z,editFinish:B})}];d.$inject=["$scope","$element","$attrs"];var e=function(a,b,c,d){};return{scope:true,restrict:"A",require:"^form",priority:-1,controller:d,link:e}}]);CSQ.directive("cqCaptureMousewheel",["$rootScope",function t(a){"use strict";var b=function(a,b,c,d){b.on("DOMMouseScroll mousewheel",function(a){var b=j$(this),c=this.scrollTop,d=this.scrollHeight,e=b.height(),f=a.originalEvent.wheelDelta,g=f>0;var h=function(){a.stopPropagation();a.preventDefault();a.returnValue=false;return false};if(!g&&-f>d-e-c){b.scrollTop(d);return h()}else if(g&&f>c){b.scrollTop(0);return h()}})};return{restrict:"A",link:b}}]);CSQ.directive("cqChoices",["$parse",function u(a){var b=function(b,c,d,e){e.$formatters.unshift(function(a){if(d.wpUserSelect=="multiple"){return a}else{return[a]}});e.$parsers.push(function(a){if(a==null||d.wpUserSelect=="multiple"){return a}else{return a.length==0?null:a[0]}});e.$render=function(){var a=c.data("chosen");if(a==null){console.log("element has no attached instance of Chosen:");console.log(c);return}if(!a.is_active())a.model_updated()};b.$watch("formStatus.disabled",function(a,b){var d=c.data("chosen");if(d)d.set_disabled(a)});b.$watch(d.cqChoices,function(a,b){var d=c.data("chosen");if(!d){console.log("element has no attached instance of Chosen:");return}d.list_updated()},true);var f={getOptions:function(){var c=a(d.cqChoices);return c(b)},getDisabledValues:function(){if(d.disabledChoices){var c=a(d.disabledChoices);return c(b)}else{return[]}},getModelValue:function(){return e.$viewValue},setModelValue:function(a){console.log(a);b.$apply(function(){e.$setViewValue(a)})},isMultiple:function(){return d.multiple}};var g={};var h=d.config;if(h){var i=a(h,b);g=i(b)}g.option_provider=f;g.width=g.width||"216px";c.chosen(g)};return{priority:0,restrict:"A",require:"ngModel",link:b}}]);CSQ.directive("cqUnsupportedOptions",["$parse",function v(a){var b=function(a,b){j$("option[value!='?']",a).each(function(a,c){if(_.contains(b,j$(this).attr("value")))j$(this).attr("disabled",true)})};return{priority:0,require:"ngModel",link:function(a,c,d,e){var f=JSON.parse(d.cqUnsupportedOptions);var g=d.ngOptions.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/);var h=g[3];a.$watch(h,function(a,d){if(a)b(c,f)},true);a.$watch(d.ngModel,function(a,d){if(a)b(c,f)})}}}]);CSQ.directive("cqDisabledOptions",["$parse",function w(a){var b=function(a,b,c,d,e){j$("option[value!='?']",c).each(function(c,f){var g={};g[b]=d[c];j$(this).attr("disabled",e(a,g))})};return{priority:0,require:"ngModel",link:function(c,d,e,f){var g=e.cqDisabledOptions.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/);var h=g[3];var i=a(g[1]);c.$watch(h,function(a,e){if(a)b(c,g[2],d,a,i)},true);c.$watch(e.ngModel,function(e,f){var j=a(h)(c);if(e)b(c,g[2],d,j,i)})}}}]);CSQ.filter("cqProperCase",function x(){return function(a){if(!a)return a;if(!angular.isString(a))return a;return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}});CSQ.filter("cqShowBlank",function y(){return function(a,b){if(b==null)b="[blank]";if(a==null)return b;if(!angular.isString(a))return a;if(a.trim().length==0)return b;return a}});CSQ.filter("cqNormalizeLink",function z(){return function(a){if(!a)return a;if(!angular.isString(a))return a;a=a.trim();if(a.length==0)return a;if(a.substr(0,4)=="http")return a;return"http://"+a}});CSQ.directive("cqSrAnnounce",function A(){return{restrict:"A",link:function(a,b,c,d){b.attr("tabindex","-1");b.addClass("sr-only")}}});CSQ.directive("cqDefaultFocus",["$rootScope","configService","$timeout",function B(a,b,c){var d=function(a,b,d){var e=function(a){var b,c,d,e=a.nodeName.toLowerCase(),f=!isNaN(j$.attr(a,"tabindex"));if("area"===e){b=a.parentNode;c=b.name;if(!a.href||!c||b.nodeName.toLowerCase()!=="map"){return false}d=j$("img[usemap=#"+c+"]")[0];return!!d&&g(d)}return(/input|select|textarea|button|object/.test(e)?!a.disabled:"a"===e?a.href||f:f)&&g(a);function g(a){return j$.expr.filters.visible(a)&&!j$(a).parents().addBack().filter(function(){return j$.css(this,"visibility")==="hidden"}).length}};c(function(){var a=b.find("h1").filter(function(){return e(this)});if(a.length==0)return;j$(a[0]).focus()});j$("body").on("keydown",function(c){a.$apply(function(){if(c.keyCode!=9)return;if(document.activeElement&&document.activeElement.tagName.toLowerCase()!="body")return;var a=b.find(":not(h1)").filter(function(){return e(this)});if(a.length==0)return;j$(a.get(0)).focus();c.preventDefault();c.stopPropagation()})})};return{restrict:"A",link:d}}]);CSQ.directive("cqUpperCase",function C(){return{priority:0,require:"ngModel",restrict:"A",link:function(a,b,c,d){b.bind("input",function(a){var c=b[0].selectionStart;b.val(function(a,b){return b.toUpperCase()});b[0].selectionStart=b[0].selectionEnd=c});d.$formatters.unshift(function(a){return a?a.toUpperCase():a});d.$parsers.push(function(a){return a?a.toUpperCase():a})}}});CSQ.directive("cqReturnKey",["$parse",function D(a){return{restrict:"A",link:function(b,c,d,e){var f=a(d.cqReturnKey);c.bind("keydown",function(a){if(a.keyCode==13){a.stopPropagation();a.preventDefault();b.$apply(f(b));return false}});c.bind("keyup",function(a){if(a.keyCode==13){a.stopPropagation();a.preventDefault();return false}})}}}]);CSQ.factory("Emitter",function(){"use strict";var a=function b(a){if(a){for(var c in b.prototype){a[c]=b.prototype[c]}return a}};a.prototype.on=a.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};a.prototype.once=function(a,b){var c=this;this._callbacks=this._callbacks||{};function d(){c.off(a,d);b.apply(this,arguments)}d.fn=b;this.on(a,d);return this};a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var c=this._callbacks[a];if(!c)return this;if(1==arguments.length){delete this._callbacks[a];return this}var d;for(var e=0;e<c.length;e++){d=c[e];if(d===b||d.fn===b){c.splice(e,1);break}}return this};a.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d){c[d].apply(this,b)}}return this};a.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};a.prototype.hasListeners=function(a){return!!this.listeners(a).length};return a});CSQ.service("geocodeService",["$rootScope","$http","$q","repositoryService","ServiceModel",function E(a,b,c,d,e){"use strict";var f={};var g=new google.maps.Geocoder;var h=new google.maps.DistanceMatrixService;function i(a){return!!_.find(a.address_components,function(a){return a.long_name=="Scotland"})}function j(a){var b=_.find(a.address_components,function(a){return _.contains(a.types,"country")});return b?b.short_name:null}function k(a){return _.filter(a,function(a){var b=j(a);return b=="GB"||b=="JE"||b=="GG"||b=="IM"})}this.geocode=function(b){b=b.toLowerCase();if(f[b])return c.when(f[b]);var d=c.defer();var e=false;g.geocode({address:b.replace(" ","+")+"+uk",region:"gb"},function h(c,g){var h=b.split(" ").join("");var j=h.indexOf("<script");if(j>-1){return d.reject("Cross-site scripting detected.")}if(g==google.maps.GeocoderStatus.ZERO_RESULTS){return d.reject("The place '"+b+"' was not found")}if(g!=google.maps.GeocoderStatus.OK){return d.reject("Unable to search at present ("+g+")")}var l=k(c);if(l.length==0){e=true;a.log(c);return d.reject("The place '"+b+"' was not found")}var m=l[0];if(_.contains(m.address_components[0].types,"country")){a.log(c);return d.reject("The place '"+b+"' was not found")}if(i(m)){a.log(c);return d.reject("For Scotland contact Alzheimer Scotland www.alzscot.org")}var n={lat:m.geometry.location.lat(),lng:m.geometry.location.lng()};_.each(m.address_components,function(a){if(a.short_name.toLowerCase().replace(" ","")===b.replace(" ",""))n.placeName=a.short_name;if(a.long_name.toLowerCase().replace(" ","")===b.replace(" ",""))n.placeName=a.long_name});f[b]=n;d.resolve(n)});return d.promise};this.getTravelTime=function(b,d,e,f,g){var h=c.defer();var i=new google.maps.LatLng(b,d);var j=new google.maps.LatLng(e,f);var k=new google.maps.DistanceMatrixService;k.getDistanceMatrix({origins:[i],destinations:[j],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL,avoidHighways:false,avoidTolls:false},function l(b,c){if(c!=google.maps.DistanceMatrixStatus.OK){a.log("Error from Google Distance Matrix API:"+c);h.resolve(null)}var d=b.rows[0].elements[0];if(d.status!=google.maps.DistanceMatrixStatus.OK){a.log("Error from Google Distance Matrix API:"+c);a.log(b);h.resolve(null)}d.distance.text=d.distance.text.replace(/mi$/,"miles").trim();h.resolve(d)});return h.promise};this.getDistanceInMiles=function l(a,b,c,d){var e=geolib.getDistance({latitude:a,longitude:b},{latitude:c,longitude:d});if(e<16093.44)return Math.round(e/160.9344)/10;return Math.round(e/1609.344)};this.getDistanceInMetres=function m(a,b,c,d){return geolib.getDistance({latitude:a,longitude:b},{latitude:c,longitude:d})}}]);CSQ.controller("ResultsController",["pageHolder","$scope","$rootScope","$q","$state","$stateParams","$timeout","configService","searchService","PageRequest","StateBasedPageProvider","$window","$location",function F(a,b,c,d,e,f,g,h,i,j,k,l,m){c.currentSearch=angular.copy(a.pageRequest.query);document.title=h.getTitle();c.currentSearch.lat=a.origin.lat;c.currentSearch.lng=a.origin.lng;b.providedBy=h.getProvidedBy();b.showHelp=h.getShowHelp();if(c.ANALYTICS)l.dco("send","pageview",{page:m.absUrl()});b.page=a.pageRequest;if(h.getProvidedBy()){var n=document.getElementsByName("robots");if(n.length==0){var o=document.createElement("meta");o.name="robots";o.content="noindex, nofollow";document.getElementsByTagName("head")[0].appendChild(o)}else{n[0].setAttribute("content","noindex, nofollow")}}c.$watch("largeContainer",function(c){b.title=(c?h.getSearchResultsTitle()+", page ":"Page ")+(a.pageNumber+1)+" of "+a.totalPages});b.serviceList=new k(a.pageRequest,a);b.selectedCategories={getCategories:function(){return b.page.query.cat},setCategories:function(a){var c=b.page.query;c.cat=a;a=1+1;if(c.dist==null)c.dist=0;b.page.page=0},getAlzheimersOnly:function(){return b.page.query.alz},setAlzheimersOnly:function(a){var c=b.page.query;c.alz=a;if(c.dist==null)c.dist=0;b.page.page=0}};b.selectedDistance={getValue:function(){return b.page.query.dist||a.radius},setValue:function(a){if(a<b.page.query.dist)b.page.page=0;b.page.query.dist=a}};b.placedata={selectedPlace:b.page.query.place};b.selectPlace=function(){var a=b.placedata.selectedPlace;if(!a||a.trim().length==0){c.alert("You must enter a postcode or place name");return}var d=angular.copy(b.page);d.query.place=a;d.query.dist=0;d.page=0;e.go("root.results.list",d.toStateParams())};b.uniqueCategories=h.uniqueCategories();b.mapRendering=e.current.name=="root.results.map";b.isMapView=function(){return e.current.name=="root.results.map"};b.showMap=function(){e.go("^.map");b.mapRendering=true};b.showList=function(){e.go("^.list");b.mapRendering=false};b.newSearch=function(){var a={p:b.page.query.place,c:b.page.query.cat};e.go("root.search",a)}}]);CSQ.controller("ListController",["$scope","$rootScope","$state","configService","searchService",function G(a,b,c,d,e){}]);CSQ.controller("MapController",["pageHolder","$scope","$rootScope","$state","CODEBASE_ROOT","NAME_SEP","configService","searchService","geocodeService",function I(a,b,c,d,e,f,g,h,i){function j(a){var b='<div style="margin:0;padding:0;xfont-size:14px;color:#555;font-weight:bold;">'+a+"</div>";return b}var k=[{id:0,originMarker:true,lat:a.origin.lat,lng:a.origin.lng,info:j("Your search location: "+a.pageRequest.query.place),options:{icon:e+"img/you_are_here"+f+"png"}}];_.each(a.content,function(a){var b={id:a.Id,lat:a.Location__Latitude__s,lng:a.Location__Longitude__s,info:j(a.Name),options:{}};k.push(b)});b.map={zoom:15,center:a.origin,options:{scrollwheel:false,panControl:false,mapTypeControl:false,draggable:c.largeContainer,streetViewControl:c.largeContainer},markers:k,markerEvents:{click:function(a,b){if(!b.id)return;d.go("root.detail",{serviceId:b.id})}}}}]);CSQ.filter("dcSearchCatFormatter",["configService",function J(a){return function(b){if(!b||!b.length){return"services"}else if(b.length===1){return a.getCategoryForId(b[0]).label+" services"}else{return"services of the selected types"}}}]);function goBack(){window.history.back()}CSQ.config(["$stateProvider","$urlRouterProvider","CODEBASE_ROOT","NAME_SEP",function K(a,b,c,d){var e=null;var f=null;b.otherwise("/search");a.state("splash",{template:'<div style="text-align: center;"><img ng-src="{{CODEBASE_ROOT}}img/dclogo{{NAME_SEP}}png" class="load-logo animLoadedLogo" ></div>'+'<div class="animLoadedLogo">'+'<p style="width:260px;margin:auto;text-align:justify">Search the Alzheimer\'s Society database of thousands of services related to Dementia</p>'+"</div>"+'<br><div class="example-hole animLoadedLogo anim-delayed" style="width:60px;margin:auto;xtext-align:center" >'+'<div class="ui-spinner" ng-class="{ demo2400:splashDelay==2400 }">'+'<span class="side side-left">'+'<span class="fill"></span>'+"</span>"+'<span class="side side-right">'+'<span class="fill"></span>'+"</span>"+"</div>"+"</div>"}).state("nosplash",{template:"<div>"+"</div>"}).state("root.category",{url:"/category?p&c",controller:"SearchController",templateUrl:c+"template/category_description"+d+"html",resolve:{place:["$q",function(a){var b=e;e=null;return a.when(b)}],alert:["$q",function(a){var b=f;f=null;return a.when(b)}]}}).state("root.disclaimer",{url:"/disclaimer?p&c",controller:"FillerPage",templateUrl:c+"template/disclaimer"+d+"html"}).state("root.faq",{url:"/faq?p&c",controller:"FillerPage",templateUrl:c+"template/faq"+d+"html"}).state("root.search",{url:"/search?p&c",controller:"SearchController",templateUrl:c+"template/service_search"+d+"html",resolve:{place:["$q",function(a){var b=e;e=null;return a.when(b)}],alert:["$q",function(a){var b=f;f=null;return a.when(b)}]}}).state("root.results",{url:"/results?p&s&o&q",controller:"ResultsController",resolve:{loaded:["$rootScope",function(a){return a.loaded}],pageHolder:["$stateParams","$state","$rootScope","$q","loaded","searchService","PageRequest",function(a,b,c,d,g,h,i){var j=i.fromStateParams(a);return h.readPage(j).then(function(a){return a},function(a){if(b.current.name.substr(0,5)!="root."){e=j.query.place;f=a;b.go("root.search")}return d.reject(a)})}]},templateUrl:c+"template/search_results"+d+"html"}).state("root.results.list",{url:"/list",controller:"ListController",templateUrl:c+"template/service_list"+d+"html"}).state("root.results.map",{url:"/map",controller:"MapController",templateUrl:c+"template/service_map"+d+"html"}).state("root.detail",{url:"/detail/:serviceId",controller:"DetailController",resolve:{loaded:["$rootScope",function(a){return a.loaded}],selectedService:["$stateParams","$rootScope","$q","loaded","searchService","ServiceModel",function(a,b,c,d,e,f){var g=a.serviceId;var h=e.findService(g);return h?c.when(h):f.find(g)}],drivingDistance:["$stateParams","$rootScope","$q","geocodeService","selectedService",function(a,b,c,d,e){if(!b.currentSearch)return c.when();return d.getTravelTime(e.Location__Latitude__s,e.Location__Longitude__s,b.currentSearch.lat,b.currentSearch.lng)}]},templateUrl:c+"template/service_detail"+d+"html"})}]);CSQ.factory("AppLoader",["$rootScope","$q","searchService",function L(a,b,c){return{authenticateUser:false,loadData:function(){return b.all([a._splash.promise])}}}]);CSQ.directive("dcConfig",["$rootScope","$parse","$state","$timeout","configService",function M(a,b,c,d,e){var f=function(f,g,h){e.setConfig(b(h.dcConfig)(f));g.attr("id","alz-dco");g.parent().css("overflow","visible");f.$watch(function(){return g.width()},function(b){a.smallContainer=b<500||screen.height<600;a.largeContainer=b>600&&screen.height>=600});var i=e.getSplash();if(i){d(function(){a._splash.resolve()},i)}else{a._splash.resolve()}if(navigator.userAgent.match(/iPhone/i)){var j=document.querySelector('meta[name="viewport"]');if(j)j.content="width=device-width, maximum-scale=1.0, initial-scale=1.0"}a.splashDelay=i;c.go(i?"splash":"nosplash")};return{restrict:"A",template:'<div style="position: relative;">'+"<div ui-view>"+"</div>",link:f}}]);CSQ.directive("dcScrollTop",["$rootScope","$window","$timeout","$state",function N(a,b,c,d){"use strict";var e=function(e,f,g){if(!window.requestAnimationFrame){c(function(){b.scrollTo(0,0)});return}var h=0;if(a.smallContainer){h=j$("[dc-config]").offset().top-56}if(d.current.name=="root.results.list"&&a.statePriorToCurrent=="root.detail"){var i=a.lastScrollPositionForState[d.current.name];if(i&&i.scrollTop&&angular.equals(i.params,d.params))h=i.scrollTop}if(Math.abs(j$(window).scrollTop()-h)<12)return;if(d.current.name!=a.statePriorToCurrent){if(a.smallContainer)j$("body").css("opacity",0);window.requestAnimationFrame(function(){c(function(){b.scrollTo(0,h);j$("body").css("opacity",1)})})}else{c(function(){b.scrollTo(0,h)})}};return{restrict:"A",link:e}}]);CSQ.directive("dcCategoryIcons",["$rootScope","configService",function O(a,b){var c=function(a,b,c){a.selectedCategories=a.dcCategoryIcons||[]};return{restrict:"A",scope:{dcCategoryIcons:"="},template:'<span ng-repeat="catg in selectedCategories" aria-hidden="true" class="fa" ng-class="catg.icon" title="{{catg.tooltip}}" ng-style="{color: catg.color}" style="font-size:100%;display:inline-block;padding:0 2px"></span>',link:c}}]);CSQ.directive("dcCategoryText",["$rootScope","configService",function P(a,b){var c=function(c,d,e){var f=c.dcCategoryText;var g=f.getCategories()||[];c.selectedCategories=_.filter(b.getCategories(),function(a){return _.contains(g,a.id)});c.text=function(){if(g.length==0){return"all services"}else if(g.length===1){return a.largeContainer?c.selectedCategories[0].label:"services"}else{return a.largeContainer?"services":g.length>2?"":"services"}}};return{restrict:"A",scope:{dcCategoryText:"="},template:'<span ng-repeat="catg in selectedCategories" aria-hidden="true" class="fa" ng-class="catg.icon" title="{{catg.tooltip}}" ng-style="{color: catg.color}" style="font-size:100%;display:inline-block;padding:0 2px"></span>&nbsp;'+'<span class="sr-only">Select service types, the present value is &nbsp</span>'+'<span ng-bind="text()"></span>',link:c}}]);CSQ.directive("dcCategoryPopover",["$rootScope","configService",function Q(a,b){var c=function(a,c,d){var e=angular.element("#dcCategoryPopover");var f=a.dcCategoryPopover;a.categories=b.getCategories();a.alzheimersOnly=b.getShowAlzheimers();a.showHelp=b.getShowHelp();a.$watch(function(){return e.is(":visible")},function(b){if(!b)return;a.alzOnly=f.getAlzheimersOnly();var c=f.getCategories();_.each(a.categories,function(a){a.selected=!c||_.contains(c,a.id)})});a.update=function(){var b=_.pluck(_.where(a.categories,{selected:true}),"id");if(b.length==a.categories.length)b=null;f.setAlzheimersOnly(a.alzOnly);f.setCategories(b);a.close()};a.close=function(){e.hide()};a.selectAll=function(){_.each(a.categories,function(a){a.selected=true})};a.selectNone=function(){_.each(a.categories,function(a){a.selected=false})};a.isEmptySelection=function(){return!_.find(a.categories,{selected:true})}};return{restrict:"A",scope:{dcCategoryPopover:"="},template:'<div id="dcCategoryPopover" class="popover bottom" cq-focus-capture="dialog" role="dialog" aria-label="select service types">'+'<div class="arrow"></div>'+'<div class="popover-content" style="margin-bottom:10px">'+'<div class="clearfix" style="font-size:12px">'+'<div class="pull-right">'+'<button class="btn btn-xs" title="Select all categories" ng-click="selectAll()"><span class="sr-only">Select&nbsp;</span>All</button>&nbsp;'+'<button class="btn btn-xs" title="De-select all categories" ng-click="selectNone()"><span class="sr-only">Select&nbsp;</span>None</button>&nbsp;'+'<button ng-show="showHelp" class="btn btn-xs" title="Category Descriptions" ui-sref="root.category()">?</button>'+"</div>"+"</div>"+'<ul class="catg-select" cq-focus-capture="list">'+'<li ng-repeat="catg in categories">'+'<label><input type="checkbox" ng-model="catg.selected">&nbsp;&nbsp;<span dc-category="{{catg.id}}"></span></label>'+"</li>"+'<div ng-show="alzheimersOnly" style="padding-bottom: 12px;margin-bottom: 14px;border-bottom: 1px solid #b3d9e7"></div>'+'<li ng-show="alzheimersOnly">'+'<label><input type="checkbox" ng-model="alzOnly">&nbsp;&nbsp;<span aria-label="Show Alzheimers society services only" title="Show Alzheimers Society Services only">Show Alzheimer&apos;s Society Only</span></spam></label>'+"</li>"+"</ul>"+'<div style="text-align: center;">'+'<button class="btn btn-primary btn-xs" ng-click="update()" ng-disabled="isEmptySelection()"><span class="fa fa-check"></span> Update</button>&nbsp;'+'<!-- <button class="btn btn-primary btn-xs" ng-click="close()"><span class="fa fa-close"></span> Cancel</button>-->'+"</div>"+"</div>"+"</div>",link:c}}]);CSQ.directive("dcCategorySelect",["$rootScope","configService",function R(a,b){var c=function(b,c,d){b.transit=function(){return a.stateTransitioning}};return{restrict:"A",scope:{dcCategorySelect:"="},template:'<div style="display:inline-block">'+'<button class="btn" cq-popover="{id:\'dcCategoryPopover\'}" ng-disabled="transit()">'+'<span dc-category-text="dcCategorySelect"></span> <i class="caret" style="color:#555"></i>'+"</button>"+'<div dc-category-popover="dcCategorySelect">'+"</div>"+"</div>",link:c}}]);CSQ.directive("dcDistanceText",["$rootScope","configService",function S(a,b){var c=function(b,c,d){var e=b.dcDistanceText;b.text=e.getValue();b.largeContainer=function(){return a.largeContainer}};return{restrict:"A",scope:{dcDistanceText:"="},template:'<span class="sr-only">Change the search radius, the present value is &nbsp</span>'+"<span aria-hidden=\"true\">{{largeContainer()?'within':'in'}} </span><span>{{text}} miles</span><span aria-hidden=\"true\"> of</span>",link:c}}]);CSQ.directive("dcDistancePopover",["$rootScope","configService",function T(a,b){var c=function(a,b,c){var d=angular.element("#dcDistancePopover");var e=a.dcDistancePopover;a.data={distance:e.getValue()};a.$watch(function(){return d.is(":visible")},function(b){a.data.distance=e.getValue()});a.update=function(){e.setValue(a.data.distance);a.close()};a.close=function(){d.hide()}};return{restrict:"A",scope:{dcDistancePopover:"="},link:c,template:'<div id="dcDistancePopover" class="popover bottom" role="dialog" aria-label="set search radius" cq-focus-capture="dialog">'+'<div class="arrow"></div>'+'<div class="popover-content" style="text-align:center;margin-top:4px;"><form>'+'<div class="catg-select" cq-focus-capture="group" role="radiogroup" aria-label="search radius">'+"<label ng-repeat=\"n in [' 5','10','15','20','25','30','40']\" style=\"font-weight:normal;padding-bottom:4px;text-align:center;font-size:13px\"><input type=\"radio\" style=\"margin:0\" name=\"distance\" ng-model=\"data.distance\" ng-value=\"{{n}}\"><span>&nbsp;&nbsp;{{n}}&nbsp;miles</span></label>"+"</div>"+'<div style="text-align:center;margin-top:6px;">'+'<button class="btn btn-primary btn-xs" ng-click="update()" ng-disabled="isEmptySelection()"><span class="fa fa-check"></span> Update</button>&nbsp;'+'<!--<button class="btn btn-primary btn-xs" ng-click="close()"><span class="fa fa-close"></span> Cancel</button>-->'+"</div>"+"</form></div>"+"</div>"}}]);CSQ.directive("dcDistanceSelect",["$rootScope","configService",function U(a,b){var c=function(b,c,d){b.transit=function(){return a.stateTransitioning};b.smallContainer=function(){return a.smallContainer}};return{restrict:"A",scope:{dcDistanceSelect:"="},link:c,template:'<div style="display:inline-block">'+'<button ng-hide="smallContainer()" class="btn" cq-popover="{id:\'dcDistancePopover\'}" style="width:auto" ng-disabled="transit()">'+'<span dc-distance-text="dcDistanceSelect"></span> <i class="caret" style="color:#555"></i>'+"</button>"+'<button ng-show="smallContainer()" class="btn btn-primary btn-sm" cq-popover="{id:\'dcDistancePopover\'}" ng-disabled="transit()" style="border-radius:3px;padding:5px 10px">'+'<span><span class="fa fa-circle-o"></span> Max Distance</span>'+"</button>"+'<div dc-distance-popover="dcDistanceSelect"></div>'}}]);CSQ.directive("dcPlaceText",["$rootScope","configService",function V(a,b){var c=function(a,b,c){var d=a.dcPlaceText;a.text=d.getValue()||"anywhere"};return{restrict:"A",scope:{dcPlaceText:"="},template:'<span class="sr-only">Set the search location, the present value is &nbsp</span>'+"<span>{{text}}</span>",link:c}}]);CSQ.directive("dcPlaceSelect",["$rootScope","$timeout","configService",function W(a,b,c){var d=function(c,d,e){var f=c.dcPlaceSelect;var g=d.find(".popover");c.$watch(function(){return g.is(":visible")},function(b){a.clearAlert();if(b)c.place=f.getValue()});c.popoverSpec={id:_.uniqueId("dc-")};c.update=function(){if(!c.place)c.place="";if(c.place.trim()==f.getValue()){c.close()}else{f.setValue(c.place)}};c.close=function(){angular.element("#"+c.popoverSpec.id).hide()};c.transit=function(){return a.stateTransitioning};a.$on("$stateChangeError",function(){b(function(){d.find('[ng-model="place"]').focus()})})};return{restrict:"A",scope:{dcPlaceSelect:"="},link:d,template:'<div style="display:inline-block">'+'<button class="btn" cq-popover="popoverSpec" ng-disabled="transit()">'+'  <span dc-place-text="dcPlaceSelect"></span> <i class="caret" style="color:#555"></i>'+"</button>"+'<div id="{{popoverSpec.id}}" class="popover bottom" cq-focus-capture="dialog" role="dialog" aria-label="Set search location.">'+'<div class="arrow"></div>'+'<div class="popover-content" style="margin-bottom:10px">'+'<form name="dcform" novalidate>'+' <input type="text" autofocus aria-label="Enter a post code or place name." class="form-control" ng-model="place" ng-disabled="transit()" required placeholder="Type a postcode or place name" style="width:210px;display:inline-block;margin:4px 0 4px 0">'+' <div cq-alert="high" dismiss="false" style="font-size:80%;width:210px"></div>'+'<div style="text-align: center;margin-top:12px;">'+' <button class="btn btn-primary btn-xs" ng-click="update()" ng-disabled="!dcform.$valid||transit()"><i class="fa fa-check"></i> OK</button>'+' <button class="btn btn-primary btn-xs" ng-click="close()" ng-disabled="transit()"><i class="fa fa-close"></i> Cancel</button>'+" </div>"+" </form>"+"</div>"+" </div>"+"</div>"}
}]);CSQ.directive("dcCategory",["$rootScope","$parse","$state","$timeout","configService",function X(a,b,c,d,e){var f=function(b,c,d){var f=b.dcCategory;if(!f)return;b.catg=e.getCategoryForId(f);if(!b.catg){a.log("Invalid category ID:"+f);return}c.find(".fa").css("color",b.catg.color);c.find(".fa").css("font-size",b.catg.icon=="fa-male"?"140%":"120%");if(b.catg.icon=="fa-male"){c.find(".fa").css("left","3px");c.find(".fa").css("position","relative")}if(b.catg.icon=="fa-plus"||b.catg.icon=="fa-info-circle"){c.find(".fa").css("left","2px");c.find(".fa").css("position","relative")}};return{restrict:"A",scope:{dcCategory:"@"},template:'<span title="{{catg.tooltip}}"><span class="fa" ng-class="catg.icon" aria-hidden="true"></span>&nbsp;{{catg.label}}</span>',link:f}}]);CSQ.directive("dcCategoryDesciption",["$rootScope","$parse","$state","$timeout","configService",function Y(a,b,c,d,e){var f=function(b,c,d){var f=d.dcCategoryDesciption;if(!f)return;b.catg=e.getCategoryForId(f);if(!b.catg){a.log("Invalid category ID:"+f);return}c.find(".fa").css("color",b.catg.color);c.find(".fa").css("font-size",b.catg.icon=="fa-male"?"140%":"120%");if(b.catg.icon=="fa-male"){c.find(".fa").css("left","3px");c.find(".fa").css("position","relative")}if(b.catg.icon=="fa-plus"||b.catg.icon=="fa-info-circle"){c.find(".fa").css("left","2px");c.find(".fa").css("position","relative")}};return{restrict:"A",scope:{dcCategory:"@"},template:'<h2  class="title">'+'   <span aria-label="{{catg.label}}{{catg.description}}" class="fa" ng-class="catg.icon" aria-hidden="true"></span>&nbsp;{{catg.label}}'+"</h2>"+'<span aria-hidden="true" class="body ng-binding">{{catg.description}}</span>',link:f}}]);CSQ.filter("dcAddress",["$rootScope",function Z(a){return function(b){var c="";if(!angular.isObject(b))return c;if(b.Default_Location__r!=null){c=(b.Default_Location__r.Address_Details__c!=null?b.Default_Location__r.Address_Details__c+", ":"")+b.Default_Location__r.Street__c;if(c.length<70)c+=", "+b.Default_Location__r.City__c}else{if(!b.service_street__c)return c;c=b.service_street__c.trim();if(!a.smallContainer&&b.service_city__c&&c.toLowerCase().indexOf(b.service_city__c.trim().toLowerCase())<0&&b.service_city__c.trim().toLowerCase()!="london")c+=", "+b.service_city__c.trim()}return c.trim().replace("\r\n",", ").replace(",,",",")}}]);CSQ.filter("dcPostcode",["$sce",function $(a){return function(b){if(!b)return"";if(!angular.isObject(b))return"";if(!b.service_postcode__c)return"";return a.trustAsHtml(b.service_postcode__c.trim().replace(/\s+/,"&nbsp;"))}}]);CSQ.directive("dcTipTour",["$rootScope","$parse","$state","$timeout","configService",function ab(a,b,c,d,e){function f(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(a){return false}}var g=function(b,c,g){if(a.smallContainer)return;if(!f())return;var h=b.cqTipTour;var i=2e3;var j="dco1";var k="cqTipTour."+j;var l=300;if(a.statePriorToCurrent=="root.search")l=300;if(_.contains(["root.results.list","root.results.map","root.detail"],a.statePriorToCurrent))l=16*3600;var m=(new Date).getTime()/1e3;var n=localStorage[k];if(n){var o=parseInt(n,10);if(m-o<l)return}localStorage[k]=+m;var p=c.find(".popover");p.css("opacity","0");p.show();function q(a,b){var e=angular.element("button[cq-popover*=dcDistance]:visible");if(e.length==0)return;c.find(".popover-content").html(a);p.position({my:"bottom-22",at:"right",of:e});p.css("opacity","1");d(function(){p.css("opacity","0")},b*1e3)}d(function(){q("Use the controls here to change your search",e.getSearchBarTooltipSeconds())},i)};return{restrict:"A",scope:{cqTipTour:"="},template:'<div class="popover black top" style="width:200px; text-align:center">'+'<div class="arrow"></div>'+'<div class="popover-content"></div>'+"</div>",link:g}}]);CSQ.run(["$rootScope","$log","$window","$timeout","$location","$q","CODEBASE_ROOT","API_ROOT","NAME_SEP","ANALYTICS",function bb(a,b,c,d,e,f,g,h,i,j){a.API_ROOT=h;a.NAME_SEP=i;a.CODEBASE_ROOT=g;a.ANALYTICS=j;a._splash=f.defer();a.log(CSQ.name+" running");if(a.ANALYTICS)dco("create",a.ANALYTICS,"auto")}]);CSQ.factory("Model",["Emitter","ClassUtils","repositoryService",function(a,b,c){"use strict";var d=["ready","error"];var e=function f(c,d){b.addProperties(this,{$$endpoint:c,$$idPropertyName:d||"id",$$emitter:new a})};e.find=function g(a,b){return c.get(b+"/"+a)};e.create=function h(a,b){return c.post(b,a)};e.prototype.get=function i(){var a=this;return c.patch(this.$$endpoint+"/"+this[this.$$idPropertyName],data).then(function(b){_.each(b,function(a,b){model[b]=a});return a})};e.prototype.patch=function j(a){var b=this;return c.patch(this.$$endpoint+"/"+this[this.$$idPropertyName],a).then(function(a){_.each(a,function(a,c){if(!_.isFunction(a))b[c]=a});return b})};e.prototype.omit=function k(){return _.omit(this,function(a,b){return _.first(b)==="_"||b==="constructor"})};e.prototype.on=function l(a,b){if(!_.contains(d,a)){throw new Error("Invalid event name: "+a)}this.$$emitter.on(a,b)};e.prototype.off=function m(a,b){this.$$emitter.off(a,b)};return e}]);CSQ.factory("PageCache",function(){"use strict";function a(a,b){var c=[];var d=function(a){var d=_.findIndex(c,function(b){if(b.pageHolder.pageRequest.page!==b.pageRequest.page)throw new Error("Inconsistent page cache");if(angular.equals(b.pageRequest,a))return true;if(b.pageHolder&&angular.equals(b.pageHolder.pageRequest,a))return true;return false});if(d<0)return d;var e=(new Date).getTime();if((e-c[d].timestamp)/1e3<b)return d;c.splice(d,1);return-1};var e=function f(){if(c.length>a)c.splice(a,c.length)};this.find=function(a){var b=d(a);if(b<0)return null;var e=c.splice(b,1);c.unshift(e[0]);return angular.copy(e[0].pageHolder)};this.add=function(a,b){if(b.pageRequest.page!==a.page)throw new Error("Inconsistent page cache add request");if(d(a)>=0)return;var f={pageRequest:angular.copy(a),pageHolder:angular.copy(b),timestamp:(new Date).getTime()};c.unshift(f);e()};this.remove=function(a){var b=d(a);if(b>=0)c.splice(b,1)};this.clear=function(a,b){c=[]};this.findContent=function(a){var b=null;_.each(c,function(c){b=_.find(c.pageHolder.content,a);if(b)return false});return b}}return a});CSQ.factory("PageHolder",function(){"use strict";return function a(b){angular.extend(this,b)}});CSQ.factory("IPageProvider",function(){"use strict";function a(){this.readPage=function(a){}}return a});CSQ.factory("StateBasedPageProvider",["$state","$q","repositoryService","PageRequest",function(a,b,c,d){"use strict";function e(c,e){var f=angular.copy(c);this.readPage=function(c){if(!angular.equals(f,c)){var g=d.toStateParams(c);a.go(a.current.name,g)}console.log("returning state base PH");return b.when(e)}}return e}]);CSQ.factory("PageRequest",function(){"use strict";function a(b,c,d,e){if(b||b===0)this["page"]=b;if(c)this["size"]=c;if(d)this["sort"]=d;if(e)this["query"]=e;this.toStateParams=function(){return a.toStateParams(this)}}a.fromStateParams=function(b){var c=b.p?parseInt(b.p):0;var d=b.s?parseInt(b.s):null;var e=b.o;var f=b.q?JSON.parse(b.q):null;return new a(c,d,e,f)};a.toStateParams=function(a){var b={};b.p=a.page?+a.page:"0";if(_.has(a,"size"))b.s=a.size;if(_.has(a,"sort"))b.o=a.sort;if(_.has(a,"query"))b.q=a.query?JSON.stringify(a.query):null;return b};return a});CSQ.service("repositoryService",["$http","$q","$rootScope","$injector","$state","$log","RestError",function cb(a,b,c,d,e,f,g){"use strict";var h={Services__c:"ServiceModel"};var i=function(a){return _.map(a,function(a){return j(a)})};var j=function(a){if(a==null||!_.isObject(a))return a;if(angular.isArray(a))return i(a);var b=a.jsClass;if(!b&&a.type)b=h[a.type];if(!b&&a.attributes&&a.attributes.type)b=h[a.attributes.type];if(!b)return a;var e;try{e=d.get(b)}catch(f){c.log(f);throw new Error("Respository service cannot get constructor for class "+b);return a}_.each(a,function(b,c){a[c]=j(b)});return new e(a)};var k=function(a,b){var c=b();if(a==null||a=="")return a;if(!c["Content-Type"]=="application/json")return a;try{if(!angular.isObject(a))a=JSON.parse(a)}catch(d){console.log('Response transformer encountered exception "'+d.message+'" while parsing JSON response "'+a+'"');console.log("Response will not be transformed");return a}return j(a)};var l=function(a){var d=a.data;if(a.status==401){c.appState="notAuth";c.currentUser=null;return b.reject(d)}if(!(d instanceof g)){var e="Response "+a.status;if(a.config)e+=" from "+a.config.method+" "+a.config.url+" ";d=new g({status:a.status,message:e})}d.request=a.config;if(!d.request||!d.request.cqSuppressErrorAlert){c.setAlert({exception:d})}f.error(d);return b.reject(d)};var m=function(a){return a.data};this.transform=function(a){try{if(!angular.isObject(a))a=JSON.parse(a)}catch(b){console.log('Response transformer encountered exception "'+b.message+'" while parsing JSON response "'+a+'"');console.log("Response will not be transformed");return a}return j(a)};this.get=function n(b,c,d){return a({method:"GET",url:b,params:c,transformResponse:k,cqSuppressErrorAlert:d}).then(m,l)};this.readPage=function o(a,b,d,e){var f=angular.copy(d)||{};f.page=b.page?b.page:0;if(b.size)f.size=b.size;if(b.sort)f.sort=b.sort;return this.get(a,f,e).then(function(a){a.pageRequest=angular.copy(b);if(a.pageRequest.page!=a.pageNumber){c.log(a);throw new Error("Inconsistent page number returned by server")}a.pageRequest.size=a.pageSize;a.pageRequest.sort=a.pageSort;return a})};this.post=function p(b,c,d){return a({method:"POST",url:b,data:c,transformResponse:k,cqSuppressErrorAlert:d}).then(m,l)};this.patch=function q(b,c,d){return a({method:"PATCH",url:b,data:c,transformResponse:k,cqSuppressErrorAlert:d}).then(m,l)};this.remove=function r(b,c){return a({method:"DELETE",url:b,transformResponse:k,cqSuppressErrorAlert:c}).then(m,l)};this["delete"]=this.remove}]);CSQ.factory("RestError",function(){"use strict";return function a(b){angular.extend(this,b)}});CSQ.controller("FillerPage",["$stateParams","$scope","$rootScope","$state","$q","geocodeService","searchService","configService","PageRequest","$window","$location",function db(a,b,c,d,e,f,g,h,i,j,k){if(c.ANALYTICS)j.dco("send","pageview",{page:k.absUrl()});if(h.getProvidedBy()){var l=document.getElementsByName("robots");if(l.length==0){var m=document.createElement("meta");m.name="robots";m.content="noindex, nofollow";document.getElementsByTagName("head")[0].appendChild(m)}else{l[0].setAttribute("content","noindex, nofollow")}}}]);CSQ.controller("SearchController",["place","alert","$stateParams","$scope","$rootScope","$state","$q","geocodeService","searchService","configService","PageRequest","$window","$location",function eb(a,b,c,d,e,f,g,h,i,j,k,l,m){d.title=j.getTitle();document.title=j.getTitle();d.address=a||c.p;d.alzheimersOnly=j.getShowAlzheimers();d.providedBy=j.getProvidedBy();if(e.ANALYTICS)l.dco("send","pageview",{page:m.absUrl()});if(j.getProvidedBy()){var n=document.getElementsByName("robots");if(n.length==0){var o=document.createElement("meta");o.name="robots";o.content="noindex, nofollow";document.getElementsByTagName("head")[0].appendChild(o)}else{n[0].setAttribute("content","noindex, nofollow")}}if(b){d.$on("$viewContentLoaded",function(){e.alert(b)})}d.categories=j.getCategories();if(c.c){var p=c.c.split(",");_.each(d.categories,function(a){a.selected=_.contains(p,a.id)})}d.runSearch=function(){if(!d.address||!d.address.trim()){e.setAlert("You must enter a postcode or place name");return}var a={place:d.address};var b=_.pluck(_.where(d.categories,{selected:true}),"id");if(b.length)a.cat=b;if(j.getShowAlzheimers())a.alz=d.alzOnly;var c=new k(0,0,null,a);f.go("root.results.list",c.toStateParams())}}]);CSQ.factory("SearchPageHolder",["geocodeService","ServiceModel",function(a,b){"use strict";return function c(d){angular.extend(this,d);var e=this.origin;this.content=_.map(this.content,function(c){var d=new b(c);d.distance=a.getDistanceInMiles(d.Location__Latitude__s,d.Location__Longitude__s,e.lat,e.lng);return d})}}]);CSQ.service("searchService",["$rootScope","$http","$q","API_ROOT","configService","repositoryService","ServiceModel","geocodeService","PageCache","$window","$location",function fb(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=new i(16,36e3);this.readPage=function(a){var b=a.query;var g=l.find(a);if(g)return c.when(g);return h.geocode(b.place).then(function(c){var g=c.lat,i=c.lng;var j=e.isGlobal()&&!b.alz;var k=!e.isHomePage();var n=e.getTypeStringForCategories(b.cat,"~");var o={lat:g,lng:i,radius:b.dist,global:j,types:n,homePage:k};return f.readPage(d+"api/search",a,o).then(function(b){_.each(b.content,function(a){a.distance=h.getDistanceInMiles(a.Location__Latitude__s,a.Location__Longitude__s,g,i)});b.content=b.content.sort(m);if(b.totalElements<b.numberOfElements){b.totalElements=b.numberOfElements}if(b.totalPages==0)b.totalPages=1;b.pageRequest.query.dist=b.distance;if(c.placeName)b.pageRequest.query.place=c.placeName;l.add(a,b);return b})})};function m(a,b){if(a.distance<b.distance)return-1;if(a.distance>b.distance)return 1;if(a.Service_Web_Name__c<b.Service_Web_Name__c)return-1;if(a.Service_Web_Name__c>b.Service_Web_Name__c)return 1;return 0}this.findService=function(a){return l.findContent({Id:a})};this.findService=function(a){return l.findContent({Id:a})}}]);CSQ.factory("ServiceModel",["Model","ClassUtils","repositoryService","configService","API_ROOT",function(a,b,c,d,e){"use strict";var f=e+"api/service";var g=function h(b){a.call(this,f);_.extend(this,b);if(this.Default_Location__r){if(this.Default_Location__r.Street__c)this.service_street__c=this.Default_Location__r.Street__c;if(this.Default_Location__r.City__c)this.service_city__c=this.Default_Location__r.City__c;if(this.Default_Location__r.Postcode__c)this.service_postcode__c=this.Default_Location__r.Postcode__c}};b.inheritPrototype(g,a);g.find=function i(b){return a.find(b,f)};g.create=function j(b){return a.create(b,f)};this._categories=null;g.prototype.getCategories=function(){if(!this._categories){this._categories=d.getCategoriesForType(this.service_type__c)}return this._categories};return g}]);function InfoBox(a){a=a||{};google.maps.OverlayView.apply(this,arguments);this.content_=a.content||"";this.disableAutoPan_=a.disableAutoPan||false;this.maxWidth_=a.maxWidth||0;this.pixelOffset_=a.pixelOffset||new google.maps.Size(0,0);this.position_=a.position||new google.maps.LatLng(0,0);this.zIndex_=a.zIndex||null;this.boxStyle_=a.boxStyle||{};this.closeBoxMargin_=a.closeBoxMargin||"2px";this.closeBoxURL_=a.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif";if(a.closeBoxURL===""){this.closeBoxURL_=""}this.infoBoxClearance_=a.infoBoxClearance||new google.maps.Size(1,1);this.isHidden_=a.isHidden||false;this.pane_=a.pane||"floatPane";this.div_=null;this.closeListener_=null;this.fixedWidthSet_=null}InfoBox.prototype=new google.maps.OverlayView;InfoBox.prototype.createInfoBoxDiv_=function(){var a;if(!this.div_){this.div_=document.createElement("div");this.setBoxStyle_();this.div_.style.position="absolute";this.div_.style.visibility="hidden";if(this.zIndex_!==null){this.div_.style.zIndex=this.zIndex_}this.div_.innerHTML=this.getCloseBoxImg_()+this.content_;this.getPanes()[this.pane_].appendChild(this.div_);this.addClickHandler_();if(this.div_.style.width){this.fixedWidthSet_=true}else{if(this.maxWidth_!==0&&this.div_.offsetWidth>this.maxWidth_){this.div_.style.width=this.maxWidth_;this.div_.style.overflow="auto";this.fixedWidthSet_=true}else{a=this.getBoxWidths_();this.div_.style.width=this.div_.offsetWidth-a.left-a.right+"px";this.fixedWidthSet_=false}}this.panBox_(this.disableAutoPan_);google.maps.event.trigger(this,"domready")}};InfoBox.prototype.getCloseBoxImg_=function(){var a="";if(this.closeBoxURL_!==""){a="<img";a+=" src='"+this.closeBoxURL_+"'";a+=" align=right";a+=" style='";a+=" position: relative;";a+=" cursor: pointer;";a+=" margin: "+this.closeBoxMargin_+";";a+="'>"}return a};InfoBox.prototype.addClickHandler_=function(){var a;if(this.closeBoxURL_!==""){a=this.div_.firstChild;this.closeListener_=google.maps.event.addDomListener(a,"click",this.getCloseClickHandler_())}else{this.closeListener_=null}};InfoBox.prototype.getCloseClickHandler_=function(){var a=this;return function(){a.close();google.maps.event.trigger(a,"closeclick")}};InfoBox.prototype.panBox_=function(a){if(!a){var b=this.getMap();var c=b.getBounds();var d=b.getDiv();var e=d.offsetWidth;var f=d.offsetHeight;var g=c.toSpan();var h=g.lng();var i=g.lat();var j=h/e;var k=i/f;var l=c.getSouthWest().lng();var m=c.getNorthEast().lng();var n=c.getNorthEast().lat();var o=c.getSouthWest().lat();var p=this.position_;var q=this.pixelOffset_.width;var r=this.pixelOffset_.height;var s=this.infoBoxClearance_.width;var t=this.infoBoxClearance_.height;var u=p.lng()+(q-s)*j;var v=p.lng()+(q+this.div_.offsetWidth+s)*j;var w=p.lat()-(r-t)*k;var x=p.lat()-(r+this.div_.offsetHeight+t)*k;var y=(u<l?l-u:0)+(v>m?m-v:0);var z=(w>n?n-w:0)+(x<o?o-x:0);if(!(z===0&&y===0)){var A=b.getCenter();b.setCenter(new google.maps.LatLng(A.lat()-z,A.lng()-y))}}};InfoBox.prototype.setBoxStyle_=function(){var a;var b=this.boxStyle_;for(a in b){if(b.hasOwnProperty(a)){this.div_.style[a]=b[a]}}if(typeof this.div_.style.opacity!=="undefined"){this.div_.style.filter="alpha(opacity="+this.div_.style.opacity*100+")"}};InfoBox.prototype.getBoxWidths_=function(){var a;var b={top:0,bottom:0,left:0,right:0};var c=this.div_;if(document.defaultView&&document.defaultView.getComputedStyle){a=c.ownerDocument.defaultView.getComputedStyle(c,"");if(a){b.top=parseInt(a.borderTopWidth,10)||0;b.bottom=parseInt(a.borderBottomWidth,10)||0;b.left=parseInt(a.borderLeftWidth,10)||0;b.right=parseInt(a.borderRightWidth,10)||0}}else if(document.documentElement.currentStyle){if(c.currentStyle){b.top=parseInt(c.currentStyle.borderTopWidth,10)||0;b.bottom=parseInt(c.currentStyle.borderBottomWidth,10)||0;b.left=parseInt(c.currentStyle.borderLeftWidth,10)||0;b.right=parseInt(c.currentStyle.borderRightWidth,10)||0}}return b};InfoBox.prototype.onRemove=function(){if(this.div_){this.div_.parentNode.removeChild(this.div_);this.div_=null}};InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var a=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=a.x+this.pixelOffset_.width+"px";this.div_.style.top=a.y+this.pixelOffset_.height+"px";if(this.isHidden_){this.div_.style.visibility="hidden"}else{this.div_.style.visibility="visible"}};InfoBox.prototype.setOptions=function(a){if(typeof a.boxStyle!=="undefined"){this.boxStyle_=a.boxStyle;this.setBoxStyle_()}if(typeof a.content!=="undefined"){this.setContent(a.content)}if(typeof a.disableAutoPan!=="undefined"){this.disableAutoPan_=a.disableAutoPan}if(typeof a.maxWidth!=="undefined"){this.maxWidth_=a.maxWidth}if(typeof a.pixelOffset!=="undefined"){this.pixelOffset_=a.pixelOffset}if(typeof a.position!=="undefined"){this.setPosition(a.position)}if(typeof a.zIndex!=="undefined"){this.setZIndex(a.zIndex)}if(typeof a.closeBoxMargin!=="undefined"){this.closeBoxMargin_=a.closeBoxMargin}if(typeof a.closeBoxURL!=="undefined"){this.closeBoxURL_=a.closeBoxURL}if(typeof a.infoBoxClearance!=="undefined"){this.infoBoxClearance_=a.infoBoxClearance}if(typeof a.isHidden!=="undefined"){this.isHidden_=a.isHidden}if(this.div_){this.draw()}};InfoBox.prototype.setContent=function(a){this.content_=a;if(this.div_){if(this.closeListener_){google.maps.event.removeListener(this.closeListener_);this.closeListener_=null}if(!this.fixedWidthSet_){this.div_.style.width=""}this.div_.innerHTML=this.getCloseBoxImg_()+a;if(!this.fixedWidthSet_){this.div_.style.width=this.div_.offsetWidth+"px";this.div_.innerHTML=this.getCloseBoxImg_()+a}this.addClickHandler_()}google.maps.event.trigger(this,"content_changed")};InfoBox.prototype.setPosition=function(a){this.position_=a;if(this.div_){this.draw()}google.maps.event.trigger(this,"position_changed")};InfoBox.prototype.setZIndex=function(a){this.zIndex_=a;if(this.div_){this.div_.style.zIndex=a}google.maps.event.trigger(this,"zindex_changed")};InfoBox.prototype.getContent=function(){return this.content_};InfoBox.prototype.getPosition=function(){return this.position_};InfoBox.prototype.getZIndex=function(){return this.zIndex_};InfoBox.prototype.show=function(){this.isHidden_=false;this.div_.style.visibility="visible"};InfoBox.prototype.hide=function(){this.isHidden_=true;this.div_.style.visibility="hidden"};InfoBox.prototype.open=function(a,b){if(b){this.position_=b.getPosition()}this.setMap(a);if(this.div_){this.panBox_()}};InfoBox.prototype.close=function(){if(this.closeListener_){google.maps.event.removeListener(this.closeListener_);this.closeListener_=null}this.setMap(null)};(function(a,b,c){"use strict";var d=b.module("ngTouch",[]);d.factory("$swipe",[function(){var a=10;function b(a){var b=a.touches&&a.touches.length?a.touches:[a];var c=a.changedTouches&&a.changedTouches[0]||a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]||b[0].originalEvent||b[0];return{x:c.clientX,y:c.clientY}}return{bind:function(c,d){var e,f;var g;var h;var i=false;c.on("touchstart mousedown",function(a){g=b(a);i=true;e=0;f=0;h=g;d["start"]&&d["start"](g,a)});c.on("touchcancel",function(a){i=false;d["cancel"]&&d["cancel"](a)});c.on("touchmove mousemove",function(c){if(!i)return;if(!g)return;var j=b(c);e+=Math.abs(j.x-h.x);f+=Math.abs(j.y-h.y);h=j;if(e<a&&f<a){return}if(f>e){i=false;d["cancel"]&&d["cancel"](c);return}else{c.preventDefault();d["move"]&&d["move"](j,c)}});c.on("touchend mouseup",function(a){if(!i)return;i=false;d["end"]&&d["end"](b(a),a)})}}}]);d.config(["$provide",function(a){a.decorator("ngClickDirective",["$delegate",function(a){a.shift();return a}])}]);d.directive("ngClick",["$parse","$timeout","$rootElement",function(a,c,d){var e=750;var f=12;var g=2500;var h=25;var i="ng-click-active";var j;var k;var l;function m(a,b,c,d){return Math.abs(a-c)<h&&Math.abs(b-d)<h}function n(a,b,c){for(var d=0;d<a.length;d+=2){if(m(a[d],a[d+1],b,c)){a.splice(d,d+2);return true}}return false}function o(a){if(Date.now()-j>g){return}var b=a.touches&&a.touches.length?a.touches:[a];var c=b[0].clientX;var d=b[0].clientY;if(c<1&&d<1){return}if(l&&l[0]===c&&l[1]===d){return}if(l){l=null}if(a.target.tagName.toLowerCase()==="label"){l=[c,d]}if(n(k,c,d)){return}a.stopPropagation();a.preventDefault();a.target&&a.target.blur()}function p(a){var b=a.touches&&a.touches.length?a.touches:[a];var d=b[0].clientX;var e=b[0].clientY;k.push(d,e);c(function(){for(var a=0;a<k.length;a+=2){if(k[a]==d&&k[a+1]==e){k.splice(a,a+2);return}}},g,false)}function q(a,b){if(!k){d[0].addEventListener("click",o,true);d[0].addEventListener("touchstart",p,true);k=[]}j=Date.now();n(k,a,b)}return function(c,d,g){var h=a(g.ngClick),j=false,k,l,m,n;function o(){j=false;d.removeClass(i)}d.on("touchstart",function(a){j=true;k=a.target?a.target:a.srcElement;if(k.nodeType==3){k=k.parentNode}d.addClass(i);l=Date.now();var b=a.touches&&a.touches.length?a.touches:[a];var c=b[0].originalEvent||b[0];m=c.clientX;n=c.clientY});d.on("touchmove",function(a){o()});d.on("touchcancel",function(a){o()});d.on("touchend",function(a){var c=Date.now()-l;var h=a.changedTouches&&a.changedTouches.length?a.changedTouches:a.touches&&a.touches.length?a.touches:[a];var i=h[0].originalEvent||h[0];var p=i.clientX;var r=i.clientY;var s=Math.sqrt(Math.pow(p-m,2)+Math.pow(r-n,2));if(j&&c<e&&s<f){q(p,r);if(k){k.blur()}if(!b.isDefined(g.disabled)||g.disabled===false){d.triggerHandler("click",[a])}}o()});d.onclick=function(a){};d.on("click",function(a,b){c.$apply(function(){h(c,{$event:b||a})})});d.on("mousedown",function(a){d.addClass(i)});d.on("mousemove mouseup",function(a){d.removeClass(i)})}}]);function e(a,b,c){d.directive(a,["$parse","$swipe",function(d,e){var f=75;var g=.3;var h=30;return function(i,j,k){var l=d(k[a]);var m,n;function o(a){if(!m)return false;var c=Math.abs(a.y-m.y);var d=(a.x-m.x)*b;return n&&c<f&&d>0&&d>h&&c/d<g}e.bind(j,{start:function(a,b){m=a;n=true},cancel:function(a){n=false},end:function(a,b){if(o(a)){i.$apply(function(){j.triggerHandler(c);l(i,{$event:b})})}}})}}])}e("ngSwipeLeft",-1,"swipeleft");e("ngSwipeRight",1,"swiperight")})(window,window.angular);(function(a,b){"use strict";function c(){}var d=Object.create(c.prototype,{version:{value:"2.0.9"},radius:{value:6378137},minLat:{value:-90},maxLat:{value:90},minLon:{value:-180},maxLon:{value:180},sexagesimalPattern:{value:/^([0-9]{1,3})°\s*([0-9]{1,3}(?:\.(?:[0-9]{1,2}))?)'\s*(([0-9]{1,3}(\.([0-9]{1,2}))?)"\s*)?([NEOSW]?)$/},measures:{value:Object.create(Object.prototype,{m:{value:1},km:{value:.001},cm:{value:100},mm:{value:1e3},mi:{value:1/1609.344},sm:{value:1/1852.216},ft:{value:100/30.48},"in":{value:100/2.54},yd:{value:1/.9144}})},prototype:{value:c.prototype},extend:{value:function(a,b){for(var c in a){if(typeof d.prototype[c]==="undefined"||b===true){d.prototype[c]=a[c]}}}}});if(typeof Number.prototype.toRad==="undefined"){Number.prototype.toRad=function(){return this*Math.PI/180}}if(typeof Number.prototype.toDeg==="undefined"){Number.prototype.toDeg=function(){return this*180/Math.PI}}d.extend({decimal:{},sexagesimal:{},distance:null,getKeys:function(a){if(Object.prototype.toString.call(a)=="[object Array]"){return{longitude:a.length>=1?0:b,latitude:a.length>=2?1:b,elevation:a.length>=3?2:b}}var c=function(b){var c;b.every(function(b){if(typeof a!="object"){return true}return a.hasOwnProperty(b)?function(){c=b;return false}():true});return c};var d=c(["lng","lon","longitude"]);var e=c(["lat","latitude"]);var f=c(["alt","altitude","elevation","elev"]);if(typeof e=="undefined"&&typeof d=="undefined"&&typeof f=="undefined"){return b}return{latitude:e,longitude:d,elevation:f}},getLat:function(a,b){return b===true?a[this.getKeys(a).latitude]:this.useDecimal(a[this.getKeys(a).latitude])},latitude:function(a){return this.getLat.call(this,a)},getLon:function(a,b){return b===true?a[this.getKeys(a).longitude]:this.useDecimal(a[this.getKeys(a).longitude])},longitude:function(a){return this.getLon.call(this,a)},getElev:function(a){return a[this.getKeys(a).elevation]},elevation:function(a){return this.getElev.call(this,a)},coords:function(a,b){var c={latitude:b===true?a[this.getKeys(a).latitude]:this.useDecimal(a[this.getKeys(a).latitude]),longitude:b===true?a[this.getKeys(a).longitude]:this.useDecimal(a[this.getKeys(a).longitude])};var d=a[this.getKeys(a).elevation];if(typeof d!=="undefined"){c["elevation"]=d}return c},validate:function(a){var b=this.getKeys(a);if(typeof b==="undefined"||typeof b.latitude==="undefined"||b.longitude==="undefined"){return false}var c=a[b.latitude];var d=a[b.longitude];if(typeof c==="undefined"||!this.isDecimal(c)&&!this.isSexagesimal(c)){return false}if(typeof d==="undefined"||!this.isDecimal(d)&&!this.isSexagesimal(d)){return false}c=this.useDecimal(c);d=this.useDecimal(d);if(c<this.minLat||c>this.maxLat||d<this.minLon||d>this.maxLon){return false}return true},getDistance:function(a,b,c){c=Math.floor(c)||1;var e=this.coords(a);var f=this.coords(b);var g=6378137,h=6356752.314245,i=1/298.257223563;var j=(f["longitude"]-e["longitude"]).toRad();var k,l,m,n,o,p;var q=Math.atan((1-i)*Math.tan(parseFloat(e["latitude"]).toRad()));var r=Math.atan((1-i)*Math.tan(parseFloat(f["latitude"]).toRad()));var s=Math.sin(q),t=Math.cos(q);var u=Math.sin(r),v=Math.cos(r);var w=j,x,y=100;do{var z=Math.sin(w),A=Math.cos(w);p=Math.sqrt(v*z*(v*z)+(t*u-s*v*A)*(t*u-s*v*A));if(p===0){return d.distance=0}k=s*u+t*v*A;l=Math.atan2(p,k);m=t*v*z/p;n=1-m*m;o=k-2*s*u/n;if(isNaN(o)){o=0}var B=i/16*n*(4+i*(4-3*n));x=w;w=j+(1-B)*i*m*(l+B*p*(o+B*k*(-1+2*o*o)))}while(Math.abs(w-x)>1e-12&&--y>0);if(y===0){return NaN}var C=n*(g*g-h*h)/(h*h);var D=1+C/16384*(4096+C*(-768+C*(320-175*C)));var E=C/1024*(256+C*(-128+C*(74-47*C)));var F=E*p*(o+E/4*(k*(-1+2*o*o)-E/6*o*(-3+4*p*p)*(-3+4*o*o)));var G=h*D*(l-F);G=G.toFixed(3);if(typeof this.elevation(a)!=="undefined"&&typeof this.elevation(b)!=="undefined"){var H=Math.abs(this.elevation(a)-this.elevation(b));G=Math.sqrt(G*G+H*H)}return this.distance=Math.floor(Math.round(G/c)*c)},getDistanceSimple:function(a,b,c){c=Math.floor(c)||1;var e=Math.round(Math.acos(Math.sin(this.latitude(b).toRad())*Math.sin(this.latitude(a).toRad())+Math.cos(this.latitude(b).toRad())*Math.cos(this.latitude(a).toRad())*Math.cos(this.longitude(a).toRad()-this.longitude(b).toRad()))*this.radius);return d.distance=Math.floor(Math.round(e/c)*c)},getCenter:function(a){if(!a.length){return false}var b=function(a){return Math.max.apply(Math,a)};var c=function(a){return Math.min.apply(Math,a)};var d;var e;var f={latitude:[],longitude:[]};for(var g in a){f.latitude.push(this.latitude(a[g]));f.longitude.push(this.longitude(a[g]))}var h=c(f.latitude);var i=c(f.longitude);var j=b(f.latitude);var k=b(f.longitude);d=((h+j)/2).toFixed(6);e=((i+k)/2).toFixed(6);var l=this.convertUnit("km",this.getDistance({latitude:h,longitude:i},{latitude:j,longitude:k}));return{latitude:d,longitude:e,distance:l}},getBounds:function(a){if(!a.length){return false}var b=this.elevation(a[0]);var c={maxLat:-Infinity,minLat:Infinity,maxLng:-Infinity,minLng:Infinity};if(typeof b!="undefined"){c.maxElev=0;c.minElev=Infinity}for(var d=0,e=a.length;d<e;++d){c.maxLat=Math.max(this.latitude(a[d]),c.maxLat);c.minLat=Math.min(this.latitude(a[d]),c.minLat);c.maxLng=Math.max(this.longitude(a[d]),c.maxLng);c.minLng=Math.min(this.longitude(a[d]),c.minLng);if(b){c.maxElev=Math.max(this.elevation(a[d]),c.maxElev);c.minElev=Math.min(this.elevation(a[d]),c.minElev)}}return c},getBoundsOfDistance:function(a,b){var c=this.latitude(a);var d=this.longitude(a);var e=c.toRad();var f=d.toRad();var g=b/this.radius;var h=e-g;var i=e+g;var j=this.maxLat.toRad();var k=this.minLat.toRad();var l=this.maxLon.toRad();var m=this.minLon.toRad();var n;var o;if(h>k&&i<j){var p=Math.asin(Math.sin(g)/Math.cos(e));n=f-p;if(n<m){n+=2*Math.PI}o=f+p;if(o>l){o-=2*Math.PI}}else{h=Math.max(h,k);i=Math.min(i,j);n=m;o=l}return[{latitude:h.toDeg(),longitude:n.toDeg()},{latitude:i.toDeg(),longitude:o.toDeg()}]},isPointInside:function(a,b){for(var c=false,d=-1,e=b.length,f=e-1;++d<e;f=d){if((this.longitude(b[d])<=this.longitude(a)&&this.longitude(a)<this.longitude(b[f])||this.longitude(b[f])<=this.longitude(a)&&this.longitude(a)<this.longitude(b[d]))&&this.latitude(a)<(this.latitude(b[f])-this.latitude(b[d]))*(this.longitude(a)-this.longitude(b[d]))/(this.longitude(b[f])-this.longitude(b[d]))+this.latitude(b[d])){c=!c}}return c},isInside:function(){return this.isPointInside.apply(this,arguments)},isPointInCircle:function(a,b,c){return this.getDistance(a,b)<c},withinRadius:function(){return this.isPointInCircle.apply(this,arguments)},getRhumbLineBearing:function(a,b){var c=this.longitude(b).toRad()-this.longitude(a).toRad();var d=Math.log(Math.tan(this.latitude(b).toRad()/2+Math.PI/4)/Math.tan(this.latitude(a).toRad()/2+Math.PI/4));if(Math.abs(c)>Math.PI){if(c>0){c=(2*Math.PI-c)*-1}else{c=2*Math.PI+c}}return(Math.atan2(c,d).toDeg()+360)%360},getBearing:function(a,b){b["latitude"]=this.latitude(b);b["longitude"]=this.longitude(b);a["latitude"]=this.latitude(a);a["longitude"]=this.longitude(a);var c=(Math.atan2(Math.sin(b["longitude"].toRad()-a["longitude"].toRad())*Math.cos(b["latitude"].toRad()),Math.cos(a["latitude"].toRad())*Math.sin(b["latitude"].toRad())-Math.sin(a["latitude"].toRad())*Math.cos(b["latitude"].toRad())*Math.cos(b["longitude"].toRad()-a["longitude"].toRad())).toDeg()+360)%360;return c},getCompassDirection:function(a,b,c){var d;var e;if(c=="circle"){e=this.getBearing(a,b)}else{e=this.getRhumbLineBearing(a,b)}switch(Math.round(e/22.5)){case 1:d={exact:"NNE",rough:"N"};break;case 2:d={exact:"NE",rough:"N"};break;case 3:d={exact:"ENE",rough:"E"};break;case 4:d={exact:"E",rough:"E"};break;case 5:d={exact:"ESE",rough:"E"};break;case 6:d={exact:"SE",rough:"E"};break;case 7:d={exact:"SSE",rough:"S"};break;case 8:d={exact:"S",rough:"S"};break;case 9:d={exact:"SSW",rough:"S"};break;case 10:d={exact:"SW",rough:"S"};break;case 11:d={exact:"WSW",rough:"W"};break;case 12:d={exact:"W",rough:"W"};break;case 13:d={exact:"WNW",rough:"W"};
break;case 14:d={exact:"NW",rough:"W"};break;case 15:d={exact:"NNW",rough:"N"};break;default:d={exact:"N",rough:"N"}}d["bearing"]=e;return d},getDirection:function(a,b,c){return this.getCompassDirection.apply(this,arguments)},orderByDistance:function(a,b){var c=[];for(var d in b){var e=this.getDistance(a,b[d]);c.push({key:d,latitude:this.latitude(b[d]),longitude:this.longitude(b[d]),distance:e})}return c.sort(function(a,b){return a.distance-b.distance})},findNearest:function(a,b,c,d){c=c||0;d=d||1;var e=this.orderByDistance(a,b);if(d===1){return e[c]}else{return e.splice(c,d)}},getPathLength:function(a){var b=0;var c;for(var d=0,e=a.length;d<e;++d){if(c){b+=this.getDistance(this.coords(a[d]),c)}c=this.coords(a[d])}return b},getSpeed:function(a,b,c){var e=c&&c.unit||"km";if(e=="mph"){e="mi"}else if(e=="kmh"){e="km"}var f=d.getDistance(a,b);var g=b.time*1/1e3-a.time*1/1e3;var h=f/g*3600;var i=Math.round(h*this.measures[e]*1e4)/1e4;return i},convertUnit:function(a,b,c){if(b===0||typeof b==="undefined"){if(this.distance===0){return 0}else{b=this.distance}}a=a||"m";c=null==c?4:c;if(typeof this.measures[a]!=="undefined"){return this.round(b*this.measures[a],c)}else{throw new Error("Unknown unit for conversion.")}},useDecimal:function(a){if(Object.prototype.toString.call(a)==="[object Array]"){var b=this;a=a.map(function(a){if(b.isDecimal(a)){return b.useDecimal(a)}else if(typeof a=="object"){if(b.validate(a)){return b.coords(a)}else{for(var c in a){a[c]=b.useDecimal(a[c])}return a}}else if(b.isSexagesimal(a)){return b.sexagesimal2decimal(a)}else{return a}});return a}else if(typeof a==="object"&&this.validate(a)){return this.coords(a)}else if(typeof a==="object"){for(var c in a){a[c]=this.useDecimal(a[c])}return a}if(this.isDecimal(a)){return parseFloat(a)}else if(this.isSexagesimal(a)===true){return parseFloat(this.sexagesimal2decimal(a))}throw new Error("Unknown format.")},decimal2sexagesimal:function(a){if(a in this.sexagesimal){return this.sexagesimal[a]}var b=a.toString().split(".");var c=Math.abs(b[0]);var d=("0."+b[1])*60;var e=d.toString().split(".");d=Math.floor(d);e=(("0."+e[1])*60).toFixed(2);this.sexagesimal[a]=c+"° "+d+"' "+e+'"';return this.sexagesimal[a]},sexagesimal2decimal:function(a){if(a in this.decimal){return this.decimal[a]}var b=new RegExp(this.sexagesimalPattern);var c=b.exec(a);var d=0,e=0;if(c){d=parseFloat(c[2]/60);e=parseFloat(c[4]/3600)||0}var f=(parseFloat(c[1])+d+e).toFixed(8);f=c[7]=="S"||c[7]=="W"?parseFloat(-f):parseFloat(f);this.decimal[a]=f;return f},isDecimal:function(a){a=a.toString().replace(/\s*/,"");return!isNaN(parseFloat(a))&&parseFloat(a)==a},isSexagesimal:function(a){a=a.toString().replace(/\s*/,"");return this.sexagesimalPattern.test(a)},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}});if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){a.geolib=module.exports=d}else if(typeof define==="function"&&define.amd){define("geolib",[],function(){return d})}else{a.geolib=d}})(this);(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}})(function(a){(function(){a.ui=a.ui||{};var b,c,d=Math.max,e=Math.abs,f=Math.round,g=/left|center|right/,h=/top|center|bottom/,i=/[\+\-]\d+(\.[\d]+)?%?/,j=/^\w+/,k=/%$/,l=a.fn.position;function m(a,b,c){return[parseFloat(a[0])*(k.test(a[0])?b/100:1),parseFloat(a[1])*(k.test(a[1])?c/100:1)]}function n(b,c){return parseInt(a.css(b,c),10)||0}function o(b){var c=b[0];if(c.nodeType===9){return{width:b.width(),height:b.height(),offset:{top:0,left:0}}}if(a.isWindow(c)){return{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}}if(c.preventDefault){return{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}}return{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.position={scrollbarWidth:function(){if(b!==undefined){return b}var c,d,e=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),f=e.children()[0];a("body").append(e);c=f.offsetWidth;e.css("overflow","scroll");d=f.offsetWidth;if(c===d){d=e[0].clientWidth}e.remove();return b=c-d},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e=c==="scroll"||c==="auto"&&b.width<b.element[0].scrollWidth,f=d==="scroll"||d==="auto"&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&c[0].nodeType===9;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d||e?c.width():c.outerWidth(),height:d||e?c.height():c.outerHeight()}}};a.fn.position=function(b){if(!b||!b.of){return l.apply(this,arguments)}b=a.extend({},b);var k,p,q,r,s,t,u=a(b.of),v=a.position.getWithinInfo(b.within),w=a.position.getScrollInfo(v),x=(b.collision||"flip").split(" "),y={};t=o(u);if(u[0].preventDefault){b.at="left top"}p=t.width;q=t.height;r=t.offset;s=a.extend({},r);a.each(["my","at"],function(){var a=(b[this]||"").split(" "),c,d;if(a.length===1){a=g.test(a[0])?a.concat(["center"]):h.test(a[0])?["center"].concat(a):["center","center"]}a[0]=g.test(a[0])?a[0]:"center";a[1]=h.test(a[1])?a[1]:"center";c=i.exec(a[0]);d=i.exec(a[1]);y[this]=[c?c[0]:0,d?d[0]:0];b[this]=[j.exec(a[0])[0],j.exec(a[1])[0]]});if(x.length===1){x[1]=x[0]}if(b.at[0]==="right"){s.left+=p}else if(b.at[0]==="center"){s.left+=p/2}if(b.at[1]==="bottom"){s.top+=q}else if(b.at[1]==="center"){s.top+=q/2}k=m(y.at,p,q);s.left+=k[0];s.top+=k[1];return this.each(function(){var g,h,i=a(this),j=i.outerWidth(),l=i.outerHeight(),o=n(this,"marginLeft"),t=n(this,"marginTop"),z=j+o+n(this,"marginRight")+w.width,A=l+t+n(this,"marginBottom")+w.height,B=a.extend({},s),C=m(y.my,i.outerWidth(),i.outerHeight());if(b.my[0]==="right"){B.left-=j}else if(b.my[0]==="center"){B.left-=j/2}if(b.my[1]==="bottom"){B.top-=l}else if(b.my[1]==="center"){B.top-=l/2}B.left+=C[0];B.top+=C[1];if(!c){B.left=f(B.left);B.top=f(B.top)}g={marginLeft:o,marginTop:t};a.each(["left","top"],function(c,d){if(a.ui.position[x[c]]){a.ui.position[x[c]][d](B,{targetWidth:p,targetHeight:q,elemWidth:j,elemHeight:l,collisionPosition:g,collisionWidth:z,collisionHeight:A,offset:[k[0]+C[0],k[1]+C[1]],my:b.my,at:b.at,within:v,elem:i})}});if(b.using){h=function(a){var c=r.left-B.left,f=c+p-j,g=r.top-B.top,h=g+q-l,k={target:{element:u,left:r.left,top:r.top,width:p,height:q},element:{element:i,left:B.left,top:B.top,width:j,height:l},horizontal:f<0?"left":c>0?"right":"center",vertical:h<0?"top":g>0?"bottom":"middle"};if(p<j&&e(c+f)<p){k.horizontal="center"}if(q<l&&e(g+h)<q){k.vertical="middle"}if(d(e(c),e(f))>d(e(g),e(h))){k.important="horizontal"}else{k.important="vertical"}b.using.call(this,a,k)}}i.offset(a.extend(B,{using:h}))})};a.ui.position={fit:{left:function(a,b){var c=b.within,e=c.isWindow?c.scrollLeft:c.offset.left,f=c.width,g=a.left-b.collisionPosition.marginLeft,h=e-g,i=g+b.collisionWidth-f-e,j;if(b.collisionWidth>f){if(h>0&&i<=0){j=a.left+h+b.collisionWidth-f-e;a.left+=h-j}else if(i>0&&h<=0){a.left=e}else{if(h>i){a.left=e+f-b.collisionWidth}else{a.left=e}}}else if(h>0){a.left+=h}else if(i>0){a.left-=i}else{a.left=d(a.left-g,a.left)}},top:function(a,b){var c=b.within,e=c.isWindow?c.scrollTop:c.offset.top,f=b.within.height,g=a.top-b.collisionPosition.marginTop,h=e-g,i=g+b.collisionHeight-f-e,j;if(b.collisionHeight>f){if(h>0&&i<=0){j=a.top+h+b.collisionHeight-f-e;a.top+=h-j}else if(i>0&&h<=0){a.top=e}else{if(h>i){a.top=e+f-b.collisionHeight}else{a.top=e}}}else if(h>0){a.top+=h}else if(i>0){a.top-=i}else{a.top=d(a.top-g,a.top)}}},flip:{left:function(a,b){var c=b.within,d=c.offset.left+c.scrollLeft,f=c.width,g=c.isWindow?c.scrollLeft:c.offset.left,h=a.left-b.collisionPosition.marginLeft,i=h-g,j=h+b.collisionWidth-f-g,k=b.my[0]==="left"?-b.elemWidth:b.my[0]==="right"?b.elemWidth:0,l=b.at[0]==="left"?b.targetWidth:b.at[0]==="right"?-b.targetWidth:0,m=-2*b.offset[0],n,o;if(i<0){n=a.left+k+l+m+b.collisionWidth-f-d;if(n<0||n<e(i)){a.left+=k+l+m}}else if(j>0){o=a.left-b.collisionPosition.marginLeft+k+l+m-g;if(o>0||e(o)<j){a.left+=k+l+m}}},top:function(a,b){var c=b.within,d=c.offset.top+c.scrollTop,f=c.height,g=c.isWindow?c.scrollTop:c.offset.top,h=a.top-b.collisionPosition.marginTop,i=h-g,j=h+b.collisionHeight-f-g,k=b.my[1]==="top",l=k?-b.elemHeight:b.my[1]==="bottom"?b.elemHeight:0,m=b.at[1]==="top"?b.targetHeight:b.at[1]==="bottom"?-b.targetHeight:0,n=-2*b.offset[1],o,p;if(i<0){p=a.top+l+m+n+b.collisionHeight-f-d;if(a.top+l+m+n>i&&(p<0||p<e(i))){a.top+=l+m+n}}else if(j>0){o=a.top-b.collisionPosition.marginTop+l+m+n-g;if(a.top+l+m+n>j&&(o>0||e(o)<j)){a.top+=l+m+n}}}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments);a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments);a.ui.position.fit.top.apply(this,arguments)}}};(function(){var b,d,e,f,g,h=document.getElementsByTagName("body")[0],i=document.createElement("div");b=document.createElement(h?"div":"body");e={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(h){a.extend(e,{position:"absolute",left:"-1000px",top:"-1000px"})}for(g in e){b.style[g]=e[g]}b.appendChild(i);d=h||document.documentElement;d.insertBefore(b,d.firstChild);i.style.cssText="position: absolute; left: 10.7432222px;";f=a(i).offset().left;c=f>10&&f<11;b.innerHTML="";d.removeChild(b)})()})();var b=a.ui.position});